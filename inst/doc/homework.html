<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Wang Qingyang" />

<meta name="date" content="2020-12-15" />

<title>Homework of StatComp</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework of StatComp</h1>
<h4 class="author">Wang Qingyang</h4>
<h4 class="date">2020-12-15</h4>



<div id="section" class="section level1">
<h1>2020.09.22</h1>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<div id="produce-an-example-containing-texts-and-at-least-one-figure" class="section level3">
<h3>Produce an example containing texts and at least one figure</h3>
</div>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="this-is-a-graph-of-10-pairs-of-random-values" class="section level3">
<h3>This is a graph of 10 pairs of random values</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a>opar &lt;-<span class="st"> </span><span class="kw">par</span>()</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">bg=</span><span class="st">&quot;lightyellow&quot;</span>, <span class="dt">col.axis=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">2.5</span>, <span class="fl">0.25</span>))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a><span class="kw">plot</span>(x, y, <span class="dt">xlab=</span><span class="st">&quot;Ten random values&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Ten other values&quot;</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a><span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">pch=</span><span class="dv">22</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">bg=</span><span class="st">&quot;yellow&quot;</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a><span class="dt">bty=</span><span class="st">&quot;l&quot;</span>, <span class="dt">tcl=</span><span class="op">-</span>.<span class="dv">25</span>, <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">cex=</span><span class="fl">1.5</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a><span class="kw">title</span>(<span class="st">&quot;A simple plot&quot;</span>, <span class="dt">font.main=</span><span class="dv">3</span>, <span class="dt">adj=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<div id="produce-an-example-containing-texts-and-at-least-one-table" class="section level3">
<h3>Produce an example containing texts and at least one table</h3>
</div>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="a-frequency-table-with-a-marginal-sum" class="section level3">
<h3>A Frequency table with a marginal sum</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="kw">library</span>(vcd)</span></code></pre></div>
<pre><code>## 载入需要的程辑包：grid</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a>b&lt;-<span class="kw">table</span>(Arthritis<span class="op">$</span>Sex,Arthritis<span class="op">$</span>Improved)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="kw">addmargins</span>(b)</span></code></pre></div>
<pre><code>##         
##          None Some Marked Sum
##   Female   25   12     22  59
##   Male     17    2      6  25
##   Sum      42   14     28  84</code></pre>
</div>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<div id="produce-an-example-containing-at-least-a-couple-of-latex-formulas" class="section level3">
<h3>Produce an example containing at least a couple of LaTeX formulas</h3>
</div>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p><span class="math inline">\(T=\frac{\bar{X}-\mu}{S/\sqrt{n}}\)</span></p>
<p><span class="math inline">\(P(X\ge\varepsilon)\le\frac{E[X]}{\varepsilon}\)</span></p>
</div>
</div>
<div id="section-1" class="section level1">
<h1>2020.09.29</h1>
<div id="question-3.3" class="section level2">
<h2>Question 3.3</h2>
<div id="the-paretoa-b-distribution-has-cdf" class="section level4">
<h4>The Pareto(a, b) distribution has cdf</h4>
</div>
<div id="fx1-fracbxa-xge-b-0a-0." class="section level4">
<h4><span class="math display">\[F(x)=1-(\frac{b}{x})^{a},    x\ge b &gt;0,a &gt;0.\]</span></h4>
</div>
<div id="derive-the-probability-inverse-transformation-f-1u-and-use-the-inverse-transform-method-to-simulate-a-random-sample-from-the-pareto2-2-distribution.-graph-the-density-histogram-of-the-sample-with-the-pareto2-2-density-superimposed-for-comparison." class="section level4">
<h4>Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto(2, 2) distribution. Graph the density histogram of the sample with the Pareto(2, 2) density superimposed for comparison.</h4>
</div>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="the-probability-inverse-transformation-f-1u-is-xfracbsqrta1-u-fxfracabaxa1when-a2b2-then-xfrac2sqrt1-ufxfrac8x3" class="section level4">
<h4>The probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> is <span class="math inline">\(X=\frac{b}{\sqrt[a]{1-U}}\)</span>, <span class="math inline">\(f(x)=\frac{ab^{a}}{x^{a+1}}\)</span>,when <span class="math inline">\(a=2,b=2\)</span>, then <span class="math inline">\(X=\frac{2}{\sqrt{1-U}}\)</span>,<span class="math inline">\(f(x)=\frac{8}{x^3}\)</span></h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a>x &lt;-<span class="dv">2</span><span class="op">/</span>(<span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">-</span>u)) <span class="co"># inverse transformation</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a><span class="kw">hist</span>(x[x<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>x<span class="op">&lt;</span><span class="dv">20</span>], <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="fl">0.5</span>), <span class="dt">main =</span> <span class="st">&quot;Histogram of the Pareto sample&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;value&quot;</span>)    <span class="co"># graph the density histogram</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x) {<span class="dv">8</span><span class="op">/</span>x<span class="op">^</span><span class="dv">3</span>}    <span class="co"># true pdf</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a><span class="kw">curve</span>(f, <span class="dv">2</span>, <span class="dv">20</span>, <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)    <span class="co"># add the true density curve</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a><span class="kw">legend</span>(<span class="dv">12</span>,<span class="fl">0.6</span>,<span class="st">&quot;true density&quot;</span>, <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">1</span>)    <span class="co"># add a legend</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-3.9" class="section level2">
<h2>Question 3.9</h2>
<div id="the-rescaled-epanechnikov-kernel-85-is-a-symmetric-density-function" class="section level4">
<h4>The rescaled Epanechnikov kernel [85] is a symmetric density function</h4>
</div>
<div id="f_exfrac341-x2xleq-1." class="section level4">
<h4><span class="math display">\[f_e(x)=\frac{3}{4}(1-x^2),|x|\leq 1.\]</span></h4>
</div>
<div id="devroye-and-gyorfi-71-p.-236-give-the-following-algorithm-for-simulation-from-this-distribution.-generate-iid-u_1-u_2-u_3-uniform1-1.-if-u_3-ge-u_2-and-u_3u_1-deliver-u_2-otherwise-deliver-u_3.-write-a-function-to-generate-random-variates-from-f_e-and-construct-the-histogram-density-estimate-of-a-large-simulated-random-sample." class="section level4">
<h4>Devroye and Gy¨orfi [71, p. 236] give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U_1, U_2, U_3\)</span> ∼ Uniform(−1, 1). If <span class="math inline">\(|U_3| \ge |U_2|\)</span> and <span class="math inline">\(|U_3|≥|U_1|\)</span>, deliver <span class="math inline">\(U_2\)</span>; otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density estimate of a large simulated random sample.</h4>
</div>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div id="i-use-dgs-method-to-simulate-the-distribution-then-draw-the-histogram-and-the-density-function-plot-to-check-the-correctness." class="section level4">
<h4>I use DG’s method to simulate the distribution, then draw the histogram and the density function plot to check the correctness.</h4>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="fl">1e4</span>;</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a>k&lt;-<span class="dv">0</span>;</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a>y &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a><span class="cf">while</span> (k <span class="op">&lt;</span><span class="st"> </span>n) {</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a>  u1 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a>  u2 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a>  u3 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a>  <span class="cf">if</span> ( <span class="kw">abs</span>(u3)<span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(u2) <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(u3)<span class="op">&gt;=</span><span class="kw">abs</span>(u1)) {</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true"></a>    x &lt;-<span class="st"> </span>u2    </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true"></a>    }<span class="cf">else</span>{</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true"></a>      x &lt;-<span class="st"> </span>u3</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true"></a>      }</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true"></a>  k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true"></a>  y[k] &lt;-<span class="st"> </span>x</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true"></a>}</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true"></a><span class="kw">hist</span>(y, <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.01</span>), <span class="dt">main =</span> <span class="st">&quot;Histogram with the density curve&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x) {<span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)}</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true"></a><span class="kw">curve</span>(f, <span class="dv">-1</span>, <span class="dv">1</span>, <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)   </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true"></a><span class="kw">legend</span>(<span class="fl">0.5</span>,<span class="fl">0.85</span>,<span class="st">&quot;true density&quot;</span>, <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">1</span>, <span class="dt">cex=</span><span class="fl">0.6</span>)    <span class="co"># add a legend</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-3.10" class="section level2">
<h2>Question 3.10</h2>
<div id="prove-that-the-algorithm-given-in-exercise-3.9-generates-variates-from-the-density-f_e-3.10." class="section level4">
<h4>Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e\)</span> (3.10).</h4>
</div>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="let-a_1-u_1leq-u_3-a_2-u_2leq-u_3-b_1-u_2leq-x-b_2-u_3leq-x" class="section level4">
<h4><span class="math display">\[Let A_1 = {|U_1|\leq |U_3|}, A_2 = {|U_2|\leq |U_3|}, B_1 = {U_2\leq x}, B_2 = {U_3\leq x}\]</span></h4>
</div>
<div id="pxleq-xpa_1-bigcap-a_2-bigcap-b_1-poverlinea_1-bigcap-a_2-bigcap-b_2" class="section level4">
<h4><span class="math display">\[P(X\leq x)=P(A_1 \bigcap A_2 \bigcap B_1) + P(\overline{A_1 \bigcap A_2} \bigcap B_2)\]</span></h4>
</div>
<div id="plefta_1-cap-a_2-cap-b_2rightiiint_d_1-fleftu_1-u_2-u_3right-du" class="section level4">
<h4><span class="math display">\[P\left(A_{1} \cap A_{2} \cap B_{2}\right)=\iiint_{D_{1}} f\left(u_{1}, u_{2}, u_{3}\right) du\]</span></h4>
</div>
<div id="when--1-leq-x0" class="section level4">
<h4><span class="math inline">\(when -1 \leq x&lt;0\)</span></h4>
</div>
<div id="d_1leftleftu_1-u_2-u_3right-u_1leq-u_3--u_3leftleq-u_2-leq-xright-u_3-mid-geq-xright" class="section level4">
<h4><span class="math display">\[D_{1}=\left\{\left(u_{1}, u_{2}, u_{3}\right)|| u_{1}|\leq| u_{3}|,-| u_{3}\left|\leq u_{2} \leq x,\right| u_{3} \mid \geq-x\right\}\]</span></h4>
</div>
<div id="beginaligned-plefta_1-cap-a_2-cap-b_1right-int_-11-int_-leftu_3rightx-int_-leftu_3rightleftu_3right-fleftu_1right-fleftu_2right-fleftu_3right-d-u_1-d-u_2-d-u_3--int_x-x-int_-leftu_3rightx-int_-leftu_3rightleftu_3right-fleftu_1right-fleftu_2right-fleftu_3right-d-u_1-d-u_2-d-u_3-frac16fracx4-fracx312-endaligned" class="section level4">
<h4><span class="math display">\[\begin{aligned}
P\left(A_{1} \cap A_{2} \cap B_{1}\right)=&amp; \int_{-1}^{1} \int_{-\left|u_{3}\right|}^{x} \int_{-\left|u_{3}\right|}^{\left|u_{3}\right|} f\left(u_{1}\right) f\left(u_{2}\right) f\left(u_{3}\right) d u_{1} d u_{2} d u_{3} \\
&amp;-\int_{x}^{-x} \int_{-\left|u_{3}\right|}^{x} \int_{-\left|u_{3}\right|}^{\left|u_{3}\right|} f\left(u_{1}\right) f\left(u_{2}\right) f\left(u_{3}\right) d u_{1} d u_{2} d u_{3} \\
=&amp; \frac{1}{6}+\frac{x}{4}-\frac{x^{3}}{12}
\end{aligned}\]</span></h4>
</div>
<div id="when-0-xleq-1" class="section level4">
<h4><span class="math inline">\(when 0 &lt; x\leq 1\)</span></h4>
</div>
<div id="d_2leftleftu_1-u_2-u_3right-u_1leq-u_3--u_3leftleq-u_2-leq-minxu_3right-u_3-le-1right" class="section level4">
<h4><span class="math display">\[D_{2}=\left\{\left(u_{1}, u_{2}, u_{3}\right)|| u_{1}|\leq| u_{3}|,-| u_{3}\left|\leq u_{2} \leq min{x,u_{3}},\right| u_{3} | \le 1\right\}\]</span></h4>
</div>
<div id="beginaligned-plefta_1-cap-a_2-cap-b_1right-int_-11-int_-leftu_3rightminxu_3-int_-leftu_3rightleftu_3right-fleftu_1right-fleftu_2right-fleftu_3right-d-u_1-d-u_2-d-u_3--int_x-x-int_-leftu_3rightx-int_-leftu_3rightleftu_3right-fleftu_1right-fleftu_2right-fleftu_3right-d-u_1-d-u_2-d-u_3-frac16fracx4-fracx312-endaligned" class="section level4">
<h4><span class="math display">\[\begin{aligned}
P\left(A_{1} \cap A_{2} \cap B_{1}\right)=&amp; \int_{-1}^{1} \int_{-\left|u_{3}\right|}^{min{x,u_{3}}} \int_{-\left|u_{3}\right|}^{\left|u_{3}\right|} f\left(u_{1}\right) f\left(u_{2}\right) f\left(u_{3}\right) d u_{1} d u_{2} d u_{3} \\
&amp;-\int_{x}^{-x} \int_{-\left|u_{3}\right|}^{x} \int_{-\left|u_{3}\right|}^{\left|u_{3}\right|} f\left(u_{1}\right) f\left(u_{2}\right) f\left(u_{3}\right) d u_{1} d u_{2} d u_{3} \\
=&amp; \frac{1}{6}+\frac{x}{4}-\frac{x^{3}}{12}
\end{aligned}\]</span></h4>
</div>
<div id="when--1-le-xleq-1" class="section level4">
<h4><span class="math inline">\(when -1 \le x\leq 1\)</span></h4>
</div>
<div id="beginaligned-pleftoverlinea_1-cap-a_2-cap-b_2right-pleftleftoverlinea_1-cap-b_2right-cupleftoverlinea_2-cap-b_2rightright-2-pleftoverlinea_1-cap-b_2right-pleftoverlinea_1-cap-overlinea_2-cap-b_2right-frac13fracx2-fracx36-endaligned" class="section level4">
<h4><span class="math display">\[
\begin{aligned}
P\left(\overline{A_{1} \cap A_{2}} \cap B_{2}\right) &amp;=P\left(\left(\overline{A_{1}} \cap B_{2}\right) \cup\left(\overline{A_{2}} \cap B_{2}\right)\right) \\
&amp;=2 P\left(\overline{A_{1}} \cap B_{2}\right)-P\left(\overline{A_{1}} \cap \overline{A_{2}} \cap B_{2}\right) \\
&amp;=\frac{1}{3}+\frac{x}{2}-\frac{x^{3}}{6}
\end{aligned}\]</span></h4>
</div>
<div id="beginaligned-px-leq-x-plefta_1-cap-a_2-cap-b_1rightpleftoverlinea_1-cap-a_2-cap-b_2right-frac16fracx4-fracx312frac16fracx4-fracx312-frac12frac3-x4-fracx34-endaligned" class="section level4">
<h4><span class="math display">\[
\begin{aligned}
P(X \leq x) &amp;=P\left(A_{1} \cap A_{2} \cap B_{1}\right)+P\left(\overline{A_{1} \cap A_{2}} \cap B_{2}\right) \\
&amp;=\frac{1}{6}+\frac{x}{4}-\frac{x^{3}}{12}+\frac{1}{6}+\frac{x}{4}-\frac{x^{3}}{12} \\
&amp;=\frac{1}{2}+\frac{3 x}{4}-\frac{x^{3}}{4}
\end{aligned}\]</span></h4>
</div>
<div id="fxfrac34left1-x2right-1-leq-x-leq-1" class="section level4">
<h4><span class="math display">\[f(x)=\frac{3}{4}\left(1-x^{2}\right),-1 \leq x \leq 1\]</span></h4>
</div>
</div>
<div id="question-3.13" class="section level2">
<h2>Question 3.13</h2>
<div id="it-can-be-shown-that-the-mixture-in-exercise-3.12-has-a-pareto-distribution-with-cdf" class="section level4">
<h4>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf</h4>
</div>
<div id="this-is-an-alternative-parameterization-of-the-pareto-cdf-given-in-exercise-3.3.-generate-1000-random-observations-from-the-mixture-with-r-4-and-β-2.-compare-the-empirical-and-theoretical-pareto-distributions-by-graphing-the-density-histogram-of-the-sample-and-superimposing-the-pareto-density-curve." class="section level4">
<h4>(This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate 1000 random observations from the mixture with r = 4 and β = 2. Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</h4>
</div>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="the-probability-inverse-transformation-f-1u-is-xfracbeta-1-sqrtr1-usqrtr1-u-fxfracrbeta-rbeta-yr1when-r4beta-2-then-xfrac2-1-sqrt41-usqrt41-ufxfrac642y5" class="section level4">
<h4>The probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> is <span class="math inline">\(X=\frac{\beta (1-\sqrt[r]{1-U})}{\sqrt[r]{1-U}}\)</span>, <span class="math inline">\(f(x)=\frac{r\beta ^{r}}{(\beta +y)^{r+1}}\)</span>,when <span class="math inline">\(r=4,\beta =2\)</span>, then <span class="math inline">\(X=\frac{2 (1-\sqrt[4]{1-U})}{\sqrt[4]{1-U}}\)</span>,<span class="math inline">\(f(x)=\frac{64}{(2+y)^5}\)</span></h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>x &lt;-<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>))<span class="op">/</span>((<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">64</span><span class="op">/</span>(<span class="dv">2</span><span class="op">+</span>x)<span class="op">^</span><span class="dv">5</span>))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">.01</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true"></a><span class="kw">lines</span>(y, <span class="dv">64</span><span class="op">/</span>(<span class="dv">2</span><span class="op">+</span>y)<span class="op">^</span><span class="dv">5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="section-2" class="section level1">
<h1>2020.10.13</h1>
<div id="question-5.1" class="section level2">
<h2>Question 5.1</h2>
<div id="compute-a-monte-carlo-estimate-of" class="section level4">
<h4>Compute a Monte Carlo estimate of</h4>
</div>
<div id="int_0pi-3-sin-t-d-t" class="section level4">
<h4><span class="math display">\[\int_{0}^{\pi / 3} \sin t d t\]</span></h4>
</div>
<div id="and-compare-your-estimate-with-the-exact-value-of-the-integral." class="section level4">
<h4>and compare your estimate with the exact value of the integral.</h4>
</div>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="x-sim-u0fracpi3gxfracpi3sinxuse-a-frequency-to-approximate-the-expectation-frac1m-sum_i1m-gx_i" class="section level4">
<h4><span class="math inline">\(X \sim U(0,\frac{\pi}{3}),g(x)=\frac{\pi}{3}sin(x)\)</span>,Use a frequency to approximate the expectation: <span class="math inline">\(\frac{1}{m} \sum_{i=1}^m g(X_i)\)</span></h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a>m &lt;-<span class="st"> </span><span class="fl">1e4</span>; </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(x)) <span class="op">*</span><span class="st"> </span>pi<span class="op">/</span><span class="dv">3</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">c</span>(theta.hat,<span class="kw">cos</span>(<span class="dv">0</span>) <span class="op">-</span><span class="st"> </span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] 0.5007474 0.5000000</code></pre>
</div>
</div>
<div id="question-5.7" class="section level2">
<h2>Question 5.7</h2>
<div id="refer-to-exercise-5.6.-use-a-monte-carlo-simulation-to-estimate-theta-by-the-antithetic-variate-approach-and-by-the-simple-monte-carlo-method.-compute-an-empirical-estimate-of-the-percent-reduction-in-variance-using-the-antithetic-variate.-compare-the-result-with-the-theoretical-value-from-exercise-5.6." class="section level4">
<h4>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</h4>
</div>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="y-gu_j-and-y_0-g1-u_j-are-negatively-correlated-in-general.-we-let-g1-estimate-theta-by-the-antithetic-variate-approach-while-let-g2estimate-theta-by-the-simple-monte-carlo-method.-when-simulating-10000-times-the-percent-reduction-in-variance-using-the-antithetic-variate-is-nearly-78.-thats-an-amazing-improvement." class="section level4">
<h4><span class="math inline">\(Y = g(U_j)\)</span> and <span class="math inline">\(Y_0 = g(1 − U_j)\)</span> are negatively correlated in general. We let g1 estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach while let g2estimate <span class="math inline">\(\theta\)</span> by the simple Monte Carlo method. When simulating 10000 times, the percent reduction in variance using the antithetic variate is nearly 78%. That’s an amazing improvement.</h4>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a>m1 &lt;-<span class="fl">1e6</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a>u1 &lt;-<span class="st"> </span><span class="kw">runif</span>(m1,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a>g1 =<span class="st"> </span><span class="kw">exp</span>(u1) <span class="co">#Estimate theta by the simple Monte Carlo method</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a>m2 &lt;-<span class="st"> </span><span class="fl">5e5</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a>u2 &lt;-<span class="st"> </span><span class="kw">runif</span>(m2,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a>g2 =<span class="st"> </span>(<span class="kw">exp</span>(u2)<span class="op">+</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>u2))<span class="op">/</span><span class="dv">2</span> <span class="co">#Estimate theta by the antithetic variate approach</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">var</span>(g2) <span class="op">/</span><span class="st"> </span><span class="kw">var</span>(g1))</span></code></pre></div>
<pre><code>## [1] 0.9838396</code></pre>
</div>
</div>
<div id="question-5.11" class="section level2">
<h2>Question 5.11</h2>
<div id="if-theta_1-and-theta_2-are-unbiased-estimators-of-theta-and-theta_1-and-theta_2-are-antithetic-we-derived-that-c-frac12-is-the-optimal-constant-that-minimizes-the-variance-of-theta_c-cˆtheta_2-1-cˆtheta_2.-derive-c-for-the-general-case.-that-is-if-theta_1-and-theta_2-are-any-two-unbiased-estimators-of-theta-find-the-value-c-that-minimizes-the-variance-of-the-estimator-theta_c-cˆtheta_2-1-cˆtheta_2-in-equation-5.11.-c-will-be-a-function-of-the-variances-and-the-covariance-of-the-estimators." class="section level4">
<h4>If <span class="math inline">\(\theta_{1}\)</span> and <span class="math inline">\(\theta_{2}\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\theta_{1}\)</span> and <span class="math inline">\(\theta_{2}\)</span> are antithetic, we derived that <span class="math inline">\(c^∗ = \frac{1}{2}\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\theta_{c} = cˆ{\theta_{2}} + (1 − c)ˆ{\theta_{2}}\)</span>. Derive <span class="math inline">\(c^∗\)</span> for the general case. That is, if <span class="math inline">\(\theta_{1}\)</span> and <span class="math inline">\(\theta_{2}\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span> , find the value <span class="math inline">\(c^∗\)</span> that minimizes the variance of the estimator <span class="math inline">\(\theta_{c} = cˆ{\theta_{2}} + (1 − c)ˆ{\theta_{2}}\)</span> in equation (5.11). (<span class="math inline">\(c^∗\)</span> will be a function of the variances and the covariance of the estimators.)</h4>
</div>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div id="operatornamevarlefthattheta_crightoperatornamevarlefthattheta_2rightc2-operatornamevarlefthattheta_1-hattheta_2right2-c-operatornamecovlefthattheta_2-hattheta_1-hattheta_2right" class="section level4">
<h4><span class="math inline">\(\operatorname{Var}\left(\hat{\theta}_{c}\right)=\operatorname{Var}\left(\hat{\theta}_{2}\right)+c^{2} \operatorname{Var}\left(\hat{\theta}_{1}-\hat{\theta}_{2}\right)+2 c \operatorname{Cov}\left(\hat{\theta}_{2}, \hat{\theta}_{1}-\hat{\theta}_{2}\right)\)</span></h4>
</div>
<div id="operatornamevarlefthattheta_2rightc2operatornamevarlefthattheta_1rightc2operatornamevarlefthattheta_2right-2c2operatornamecovlefthattheta_1-hattheta_2right2coperatornamecovlefthattheta_1-hattheta_2right-2coperatornamevarlefthattheta_2right" class="section level4">
<h4><span class="math inline">\(=\operatorname{Var}\left(\hat{\theta}_{2}\right)+c^2\operatorname{Var}\left(\hat{\theta}_{1}\right)+c^2\operatorname{Var}\left(\hat{\theta}_{2}\right)-2c^2\operatorname{Cov}\left(\hat{\theta}_{1}, \hat{\theta}_{2}\right)+2c\operatorname{Cov}\left(\hat{\theta}_{1}, \hat{\theta}_{2}\right)-2c\operatorname{Var}\left(\hat{\theta}_{2}\right)\)</span></h4>
</div>
<div id="operatornamevarhattheta_1-hattheta_2c22operatornamecovhattheta_1hattheta_2-operatornamevarhattheta_2coperatornamevarhattheta_2" class="section level4">
<h4><span class="math inline">\(=\operatorname{Var}(\hat\theta_1-\hat\theta_2)c^2+2(\operatorname{Cov}(\hat\theta_1,\hat\theta_2)-\operatorname{Var}(\hat\theta_2))c+\operatorname{Var}(\hat\theta_2)\)</span></h4>
<p>So, <span class="math inline">\(c^*= \begin{cases} 0 &amp; ~~~~ \frac{Var(\hat{\theta}_2)-Cov(\hat{\theta}_1,\hat{\theta}_2)}{Var(\hat{\theta}_1)+Var(\hat{\theta}_2)-2Cov(\hat{\theta}_1,\hat{\theta}_2)} &lt;0\\ \frac{Var(\hat{\theta}_2)-Cov(\hat{\theta}_1,\hat{\theta}_2)}{Var(\hat{\theta}_1)+Var(\hat{\theta}_2)-2Cov(\hat{\theta}_1,\hat{\theta}_2)} &amp;~~~~ 0 \leq \frac{Var(\hat{\theta}_2)-Cov(\hat{\theta}_1,\hat{\theta}_2)}{Var(\hat{\theta}_1)+Var(\hat{\theta}_2)-2Cov(\hat{\theta}_1,\hat{\theta}_2)} \leq 1 \\ 1 &amp; ~~~~ \frac{Var(\hat{\theta}_2)-Cov(\hat{\theta}_1,\hat{\theta}_2)}{Var(\hat{\theta}_1)+Var(\hat{\theta}_2)-2Cov(\hat{\theta}_1,\hat{\theta}_2)} &gt;1\\ \end{cases}\)</span> minimizes the variance of the estimator.</p>
</div>
</div>
</div>
<div id="section-3" class="section level1">
<h1>2020.10.20</h1>
<div id="question-5.13" class="section level2">
<h2>Question 5.13</h2>
<div id="find-two-importance-functions-f1-and-f2-that-are-supported-on-1-and-are-close-to" class="section level4">
<h4>Find two importance functions f1 and f2 that are supported on (1, ∞) and are ‘close’ to</h4>
</div>
<div id="gxfracx2sqrt2pie-fracx22-x1." class="section level4">
<h4><span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}},    x&gt;1.\]</span></h4>
</div>
<div id="which-of-your-two-importance-functions-should-produce-the-smaller-variance-in-estimating" class="section level4">
<h4>Which of your two importance functions should produce the smaller variance in estimating</h4>
</div>
<div id="int_1inftyfracx2sqrt2pie-fracx22dx" class="section level4">
<h4><span class="math display">\[\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}\,dx\]</span></h4>
</div>
<div id="by-importance-sampling-explain." class="section level4">
<h4>by importance sampling? Explain.</h4>
</div>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<div id="i-use-three-functions-to-solve-this-problem." class="section level4">
<h4>I use three functions to solve this problem.</h4>
</div>
<div id="f_1-e1-x" class="section level4">
<h4><span class="math display">\[f_1 = e^{1-x}\]</span></h4>
</div>
<div id="x-sim-weibull10.5-which-is-like-exponential-distribution" class="section level4">
<h4><span class="math display">\[X \sim Weibull(1,0.5)\]</span> which is like Exponential Distribution</h4>
</div>
<div id="x-sim-cauchy" class="section level4">
<h4><span class="math display">\[X \sim cauchy\]</span></h4>
</div>
<div id="f1-performs-the-best-and-is-easy-to-simulatef3-performs-the-worst-which-has-larger-ranges-and-many-of-the-simulated-values-will-contribute-zeros-to-the-sum-which-is-inefficient." class="section level4">
<h4>F1 performs the best and is easy to simulate,f3 performs the worst which has larger ranges and many of the simulated values will contribute zeros to the sum, which is inefficient.</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>theta.hat &lt;-<span class="st"> </span>se &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a>  x<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a>}</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">rgamma</span>(m,<span class="dv">3</span>,<span class="dv">2</span>) <span class="co">#using f1</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">dgamma</span>(x,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true"></a>theta.hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true"></a>se[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">rweibull</span>(m,<span class="dv">2</span>,<span class="kw">sqrt</span>(<span class="dv">2</span>)) <span class="co">#using f2</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">dweibull</span>(x,<span class="dv">2</span>,<span class="kw">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true"></a>theta.hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true"></a>se[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true"></a>theta.hat</span></code></pre></div>
<pre><code>## [1] 0.4002789 0.3998733</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a>se</span></code></pre></div>
<pre><code>## [1] 0.3023981 0.3653418</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a><span class="kw">rbind</span>(theta.hat,se)</span></code></pre></div>
<pre><code>##                [,1]      [,2]
## theta.hat 0.4002789 0.3998733
## se        0.3023981 0.3653418</code></pre>
<p>We can see <span class="math inline">\(\Gamma(3,2)\)</span> produces smaller variance</p>
<p>We can draw the curve of <span class="math inline">\(g,f1, f2\)</span> and compare them with each other.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a>t&lt;-<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a>g&lt;-<span class="kw">exp</span>(<span class="op">-</span>t<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>t<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a>f1&lt;-<span class="kw">dgamma</span>(t,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a>f2&lt;-<span class="kw">dweibull</span>(t,<span class="dv">2</span>,<span class="kw">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true"></a> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true"></a><span class="co">####get the curve of g,f1 and f2####</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true"></a><span class="kw">plot</span>(t,g,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>,<span class="dt">main=</span><span class="st">&quot;compare g(t), f1(t) and f2(t) &quot;</span>)   </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true"></a><span class="kw">lines</span>(t,f1,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)  </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true"></a><span class="kw">lines</span>(t,f2,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)  </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend =</span><span class="kw">c</span>(<span class="st">&#39;g(t)&#39;</span>,<span class="st">&#39;f1(t)&#39;</span>,<span class="st">&quot;f2(t)&quot;</span>) ,<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;green&quot;</span>)) </span></code></pre></div>
<p><img src="data:image/png;base64,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QDW4yChGQveYAI1aHF6sDqjmHADhi9UB1ZwBII9LjQHVnAEgj4vVAdWcASDyICR8V2NANecACF+sDqjmLABdoAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAhoAkDVzOBOpe4UAZ/wGEzCyycGtM6mLmzIb0LmYvJAT50eUG1mcJdydw6FT2B32DmNZOKTKA5C6puQYoppb0KnB1TNDO7SYecEJJOZTiNylufUzlB9E1KacpRraqoYhA5Z9uLPLkBP38IjjgDpb0L6HbBSUwECk1QzAM4YlF//d4cCGTzF1AfrBGvvuw4TAQJJbO72TkAZPzvQVOkw+Aoq0pe9g9A0gHIQo/lNEjegK3zYuZNWUwAbmxErIHQTRHi9G5BAU00HbTKCY0usp1iGRkFqZmNH/JD74wzVHp4RaZDO3KM3LacHqa8+uPZK7rizSB5lN+8OC5XcI2kepWp3do0G/GJQdAPFamZwt8ClRo6vV1JURLlXFtelxsJFgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIENACAOVeD4ecSvEDqk1nMIcIEFD0gPgT9sGv6Y+o6AGRByERICACBESAgAgQEAECOuwC5yoaV/EDKlIaB8UsAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAAB/Q4N1HpyDbizbAAAAABJRU5ErkJggg==" /><!-- --></p>
<p>Then,we draw the ration functions and make comparison, which are g/f1 and g/f2.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a>t&lt;-<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a> g&lt;-<span class="kw">exp</span>(<span class="op">-</span>t<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>t<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true"></a> f2&lt;-<span class="kw">dweibull</span>(t,<span class="dv">2</span>,<span class="kw">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true"></a> f1&lt;-<span class="kw">dgamma</span>(t,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true"></a>r1&lt;-g<span class="op">/</span>f1</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true"></a>r2&lt;-g<span class="op">/</span>f2</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true"></a><span class="kw">plot</span>(t,r2,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true"></a><span class="kw">lines</span>(t,r1,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true"></a><span class="kw">title</span>(<span class="dt">main=</span><span class="st">&quot;ratio function&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> From the above plots,the curve of <span class="math inline">\(g(x)/f_1(x)\)</span> is more “close” to constant,</p>
<p>which means <span class="math inline">\(f_1(x)\)</span> is more “close” to <span class="math inline">\(g(x)\)</span>.</p>
<p><span class="math inline">\(\therefore~f_1(x)=\Gamma(3,2)\)</span> produces smaller variance.</p>
</div>
</div>
<div id="question-5.15" class="section level2">
<h2>Question 5.15</h2>
<div id="obtain-the-stratified-importance-sampling-estimate-in-example-5.13-and-compare-it-with-the-result-of-example-5.10." class="section level4">
<h4>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</h4>
</div>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<div id="i-compare-the-most-effective-method-which-is-the-fourth-method-in-5.10-using-the-importance-sampling-estimate-and-the-stratified-importance-sampling-estimate.-the-stratified-importance-sampling-estimate-performs-better." class="section level4">
<h4>I compare the most effective method which is the fourth method in 5.10 using the importance sampling estimate and the stratified importance sampling estimate. The stratified importance sampling estimate performs better.</h4>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a>M &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a>k &lt;-<span class="st"> </span><span class="dv">5</span> <span class="co">#number of strata</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true"></a>r &lt;-<span class="st"> </span>M <span class="op">/</span><span class="st"> </span>k <span class="co">#replicates per stratum</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true"></a>N &lt;-<span class="st"> </span><span class="dv">50</span> <span class="co">#number of times to repeat the estimation</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true"></a>T2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true"></a>estimates &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true"></a><span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true"></a>}</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(M) <span class="co">#f3, inverse transform method</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(M) <span class="co">#f3, inverse transform method</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true"></a>  x &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true"></a>  fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true"></a>  estimates[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true"></a>    u &lt;-<span class="st"> </span><span class="kw">runif</span>(M<span class="op">/</span>k, (j<span class="dv">-1</span>)<span class="op">/</span>k, j<span class="op">/</span>k)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true"></a>    x &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true"></a>    fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true"></a>    T2[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)}</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true"></a>  estimates[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(T2)</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true"></a>}</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true"></a><span class="kw">apply</span>(estimates, <span class="dv">2</span>, mean)</span></code></pre></div>
<pre><code>## [1] 0.5246815 0.5248292</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a><span class="kw">apply</span>(estimates, <span class="dv">2</span>, var)</span></code></pre></div>
<pre><code>## [1] 7.010101e-07 4.400115e-08</code></pre>
</div>
</div>
<div id="question-6.4" class="section level2">
<h2>Question 6.4</h2>
<div id="suppose-that-x_1...x_n-are-a-random-sample-from-a-from-a-lognormal-distribution-with-unknown-parameters.-construct-a-95-confidence-interval-forthe-parameter-mu.-use-a-monte-carlo-method-to-obtain-an-empirical-estimateof-the-confidence-level." class="section level4">
<h4>Suppose that <span class="math inline">\(X_1,...,X_n\)</span> are a random sample from a from a lognormal distribution with unknown parameters. Construct a 95% confidence interval forthe parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimateof the confidence level.</h4>
</div>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<div id="xlnynmusigma-2eyemu-sigma-2so-the-ci-of-mu-can-transfer-to-the-ci-of-w-lneymu-sigma-2vwfracleftbarxfracs22-wright-sqrtnsqrts2left1fracs22rightthe-ci-of-w-is-leftbarxfracs22-t_1-sqrtfracs2left1fracs22rightn-barxfracs22t_0-sqrtleft.fracs2left1fracs22rightnrightright." class="section level4">
<h4><span class="math inline">\(X=ln(Y)\)</span>~<span class="math inline">\(N(\mu,\sigma ^2)\)</span>,<span class="math inline">\(EY=e^{\mu +\sigma ^2}\)</span>,so the CI of <span class="math inline">\(\mu\)</span> can transfer to the CI of <span class="math inline">\(W = ln(EY)=\mu +\sigma ^2\)</span>,<span class="math inline">\(V[W]=\frac{\left(\bar{X}+\frac{S^{2}}{2}-W\right) \sqrt{n}}{\sqrt{S^{2}\left(1+\frac{S^{2}}{2}\right)}}\)</span>,the CI of W is <span class="math inline">\(\left\{\bar{X}+\frac{S^{2}}{2}-T_{1} \sqrt{\frac{S^{2}\left(1+\frac{S^{2}}{2}\right)}{n}}, \bar{X}+\frac{S^{2}}{2}+T_{0} \sqrt{\left.\frac{S^{2}\left(1+\frac{S^{2}}{2}\right)}{n}\right\}}\right.\)</span></h4>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true"></a>UCL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true"></a>s &lt;-<span class="st"> </span><span class="kw">sum</span>((x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>(n<span class="dv">-1</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true"></a>(<span class="dv">3</span><span class="op">/</span><span class="dv">2</span><span class="op">-</span><span class="kw">mean</span>(x)<span class="op">-</span>s<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(s<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>s<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>n)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true"></a>} )</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true"></a><span class="co">#count the number of intervals that contain sigma^2=4</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true"></a><span class="kw">sum</span>(<span class="kw">abs</span>(UCL)<span class="op">&lt;=</span><span class="fl">2.093</span>)</span></code></pre></div>
<pre><code>## [1] 943</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a><span class="co">#or compute the mean to get the confidence level</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true"></a><span class="kw">mean</span>(<span class="kw">abs</span>(UCL)<span class="op">&lt;=</span><span class="fl">2.093</span>)</span></code></pre></div>
<pre><code>## [1] 0.943</code></pre>
</div>
</div>
<div id="question-6.5" class="section level2">
<h2>Question 6.5</h2>
<div id="suppose-a-95-symmetric-t-interval-is-applied-to-estimate-a-mean-but-the-sample-data-are-non-normal.-then-the-probability-that-the-confidence-interval-covers-the-mean-is-not-necessarily-equal-to-0.95.-use-a-monte-carlo-experiment-to-estimate-the-coverage-probability-of-the-t-interval-for-random-samples-of-chi22-data-with-sample-size-n-20.-compare-your-t-interval-results-with-the-simulation-results-in-example-6.4.-the-t-interval-should-be-more-robust-to-departures-from-normality-than-the-interval-for-variance." class="section level4">
<h4>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</h4>
</div>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<div id="let-t-fracsqrtnmu--hatmus-because-the-sample-data-are-non-normal-so-the-confidence-interval-covers-the-mean-is-not-equal-to-0.95." class="section level4">
<h4>Let <span class="math inline">\(T = \frac{\sqrt{n}(\mu -\hat{\mu})}{s}\)</span>, because the sample data are non-normal, so the confidence interval covers the mean is not equal to 0.95.</h4>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true"></a>UCLvar1 &lt;-<span class="st"> </span>UCLmean1 &lt;-<span class="st"> </span>UCLvar2 &lt;-<span class="st"> </span>UCLmean2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true"></a>UCLvar &lt;-<span class="st"> </span>UCLmean &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true"></a>UCLvar1 &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true"></a>(n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df =</span> n<span class="dv">-1</span>) })</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true"></a>UCLvar[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(UCLvar1 <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true"></a>UCLvar2 &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true"></a>(n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true"></a>} )</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true"></a>UCLvar[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(UCLvar2 <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true"></a>UCLmean1 &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>,<span class="dt">expr=</span>{</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true"></a>  (<span class="kw">mean</span>(y)<span class="op">-</span><span class="kw">sd</span>(y)<span class="op">*</span><span class="kw">qt</span>(<span class="dt">df=</span>n<span class="dv">-1</span>,alpha)<span class="op">/</span><span class="kw">sqrt</span>(n))</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true"></a>  </span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true"></a>})</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true"></a>UCLmean[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(UCLmean1 <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true"></a></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true"></a>UCLmean2 &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>,<span class="dt">expr=</span>{</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true"></a>  y &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">2</span>)</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true"></a>  (<span class="kw">mean</span>(y)<span class="op">-</span><span class="kw">sd</span>(y)<span class="op">*</span><span class="kw">qt</span>(<span class="dt">df=</span>n<span class="dv">-1</span>,alpha)<span class="op">/</span><span class="kw">sqrt</span>(n))</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true"></a>  </span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true"></a>})</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true"></a>UCLmean[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(UCLmean2 <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>)</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true"></a></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true"></a>f &lt;-<span class="kw">data.frame</span>(UCLmean,UCLvar,<span class="dt">row.names =</span> <span class="kw">c</span>(<span class="st">&quot;normal distribution&quot;</span>,<span class="st">&quot;chi-square distribution&quot;</span>))</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(f)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">UCLmean</th>
<th align="right">UCLvar</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">normal distribution</td>
<td align="right">0.958</td>
<td align="right">0.943</td>
</tr>
<tr class="even">
<td align="left">chi-square distribution</td>
<td align="right">0.888</td>
<td align="right">0.813</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="section-4" class="section level1">
<h1>2020.10.27</h1>
<div id="question-6.7" class="section level2">
<h2>Question 6.7</h2>
<div id="estimate-the-power-of-the-skewness-test-of-normality-against-symmetric-betaα-α-distributions-and-comment-on-the-results.-are-the-results-different-for-heavy-tailed-symmetric-alternatives-such-as-tν" class="section level4">
<h4>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(α, α)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(ν)\)</span>?</h4>
</div>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<div id="i-estimate-the-power-of-the-skewness-test-of-normality-against-symmetric-beta1-1-and-t10.-when-alpha-and-ν-is-differert-from-the-fixed-value-which-is-set-by-me-the-anwser-is-the-same.-the-power-of-the-skewness-test-of-normality-against-symmetric-betaα-α-distributions-is-far-below-0.01-while-the-power-of-the-skewness-test-of-normality-against-symmetric-tν-distributions-is-higer-than-0.1.-i-think-the-reason-of-the-results-is-that-beta1-1-is-symmetric-distributions-with-light-tails-while-tν-is-symmetric-distributions-with-heavy-tails." class="section level4">
<h4>I estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(1, 1)\)</span> and <span class="math inline">\(t(10)\)</span>. When <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(ν\)</span> is differert from the fixed value which is set by me, the anwser is the same. The power of the skewness test of normality against symmetric <span class="math inline">\(Beta(α, α)\)</span> distributions is far below 0.01 while the power of the skewness test of normality against symmetric <span class="math inline">\(t(ν)\)</span> distributions is higer than 0.1. I think the reason of the results is that <span class="math inline">\(Beta(1, 1)\)</span> is symmetric distributions with light tails while <span class="math inline">\(t(ν)\)</span> is symmetric distributions with heavy tails.</h4>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true"></a><span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true"></a>xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true"></a>m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true"></a>m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true"></a><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true"></a>}</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true"></a><span class="co"># beta(a,a)</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true"></a>pwr_beta =<span class="st"> </span><span class="cf">function</span>(a){</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true"></a> alpha =<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true"></a> n =<span class="st"> </span><span class="dv">20</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true"></a> m =<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true"></a> N =<span class="st"> </span><span class="kw">length</span>(a)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true"></a> pwr =<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true"></a> cv =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true"></a> </span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true"></a> <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true"></a>  sktests =<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true"></a>   x =<span class="st"> </span><span class="kw">rbeta</span>(n, a[j], a[j])</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true"></a>   sktests[i] =<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x))<span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true"></a>  }</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true"></a>  pwr[j] =<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true"></a> }</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true"></a> se =<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) </span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true"></a> <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">pwr =</span> pwr,<span class="dt">se =</span> se))</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true"></a>}</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true"></a></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true"></a> a =<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>),<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>,<span class="dv">1</span>),<span class="kw">seq</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="dv">10</span>))</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true"></a> pwr =<span class="st"> </span><span class="kw">pwr_beta</span>(a)<span class="op">$</span>pwr</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true"></a> <span class="co"># plot the power</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true"></a> se =<span class="st"> </span><span class="kw">pwr_beta</span>(a)<span class="op">$</span>se</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true"></a> <span class="kw">plot</span>(a, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;pwr&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true"></a> <span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">0.1</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true"></a> <span class="kw">lines</span>(a, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">4</span>)</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true"></a> <span class="kw">lines</span>(a, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The power of the skewness test of normality against symmetric Beta(a,a) distribution is under 0.1. For a&lt; 1, the empirical power is more and more far away from 0.1 With the increase of a. And for a&gt;1, the empirical power increases to 0.1 when a increases.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true"></a><span class="co"># t(v)</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true"></a>pwr_t =<span class="st"> </span><span class="cf">function</span>(v){</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true"></a> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true"></a> alpha =<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true"></a> n =<span class="st"> </span><span class="dv">20</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true"></a> m =<span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true"></a> N =<span class="st"> </span><span class="kw">length</span>(v)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true"></a> pwr =<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true"></a> cv =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true"></a> </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true"></a> <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true"></a>  sktests =<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true"></a>   x =<span class="st"> </span><span class="kw">rt</span>(n,v[j])</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true"></a>   sktests[i] =<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x))<span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true"></a>  }</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true"></a>  pwr[j] =<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true"></a> }</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true"></a> se =<span class="st"> </span><span class="kw">sqrt</span>(pwr<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">pwr =</span> pwr,<span class="dt">se =</span> se))</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true"></a>}</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true"></a></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true"></a>v =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>)</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true"></a>pwr =<span class="st"> </span><span class="kw">pwr_t</span>(v)<span class="op">$</span>pwr</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true"></a>se =<span class="st"> </span><span class="kw">pwr_t</span>(v)<span class="op">$</span>se</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true"></a><span class="co"># plot the power</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true"></a><span class="kw">plot</span>(v, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;v&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;pwr&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">pch=</span><span class="dv">16</span>)</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">0.1</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true"></a><span class="kw">lines</span>(v, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">4</span>)</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true"></a><span class="kw">lines</span>(v, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> For t distribution, the empirical power is always bigger than 0.1 and it decreases to 0.1 with the increase of v.</p>
</div>
</div>
<div id="question-6.8" class="section level2">
<h2>Question 6.8</h2>
<div id="refer-to-example-6.16.-repeat-the-simulation-but-also-compute-the-f-test-of-equal-variance-at-significance-level-hatα-doteq-0.055.-compare-the-power-of-the-count-five-test-and-f-test-for-small-medium-and-large-sample-sizes.-recall-that-the-f-test-is-not-applicable-for-non-normal-distributions." class="section level4">
<h4>Refer to Example 6.16. Repeat the simulation, but also compute the F test of equal variance, at significance level <span class="math inline">\(\hat{α} \doteq 0.055\)</span>. Compare the power of the Count Five test and F test for small, medium, and large sample sizes. (Recall that the F test is not applicable for non-normal distributions.)</h4>
</div>
</div>
<div id="answer-15" class="section level2">
<h2>Answer</h2>
<div id="the-two-methods-both-have-small-power-in-small-sizes-middle-power-in-middle-sizes-and-large-power-in-large-sizes.-but-the-power-of-f-test-is-always-bigger-than-that-of-the-count-five-test." class="section level4">
<h4>The two methods both have small power in small sizes, middle power in middle sizes and large power in large sizes. But the power of F test is always bigger than that of the Count Five test.</h4>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true"></a>X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true"></a>Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true"></a>outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true"></a>outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true"></a><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true"></a>}</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true"></a>power1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true"></a>  power1[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true"></a>    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma1)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma2)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true"></a>    <span class="kw">count5test</span>(x, y)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true"></a>}))</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true"></a>}</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true"></a></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>)</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true"></a>power2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true"></a>  pvalues &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> {</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true"></a>    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma1)</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma2)</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true"></a>    ftest &lt;-<span class="st"> </span><span class="kw">var.test</span>(x,y)</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true"></a>    ftest<span class="op">$</span>p.value } )</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true"></a>  power2[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(pvalues <span class="op">&lt;=</span><span class="st"> </span><span class="fl">.055</span>)</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true"></a>}</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true"></a><span class="kw">data.frame</span>(<span class="dt">n=</span>n, <span class="dt">C5=</span>power1, <span class="dt">Fp=</span>power2)</span></code></pre></div>
<pre><code>##     n     C5     Fp
## 1  10 0.1033 0.2117
## 2  20 0.3144 0.4156
## 3  30 0.4738 0.5849
## 4  50 0.6623 0.8155
## 5 100 0.8494 0.9823
## 6 500 0.9907 1.0000</code></pre>
</div>
</div>
<div id="question-6.c" class="section level2">
<h2>Question 6.C</h2>
<div id="repeat-examples-6.8-and-6.10-for-mardias-multivariate-skewness-test.-mardia-187-proposed-tests-of-multivariate-normality-based-on-multivariate-generalizations-of-skewness-and-kurtosis.-if-x-and-y-are-iid-the-multivariate-population-skewness-β_1d-is-defined-by-mardia-as" class="section level4">
<h4>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If X and Y are iid, the multivariate population skewness <span class="math inline">\(β_{1,d}\)</span> is defined by Mardia as</h4>
</div>
<div id="β_1d-e-x-mut-σ1y-mu3." class="section level4">
<h4><span class="math display">\[β_{1,d} = E [(X − \mu)^T Σ^{−1}(Y − \mu)]^3\]</span>.</h4>
</div>
<div id="under-normality-β_1d-0-.the-multivariate-skewness-statistic-is" class="section level4">
<h4>Under normality, <span class="math inline">\(β_{1,d} = 0\)</span> .The multivariate skewness statistic is</h4>
</div>
<div id="b_1d-frac1n2-sumlimits_ij1nx_i-barxt-widehatσ1x_j-barx3." class="section level4">
<h4><span class="math display">\[b_{1,d} = \frac{1}{n^2} \sum\limits_{i,j=1}^n((X_i − \bar{X})^T \widehat{Σ}^{−1}(X_j − \bar{X}))^3\]</span>.</h4>
</div>
<div id="where-widehatσ-is-the-maximum-likelihood-estimator-of-covariance.-large-values-of-b_1d-are-significant.-the-asymptotic-distribution-of-nb_1d6-is-chisquared-with-dd-1d-26-degrees-of-freedom." class="section level4">
<h4>where <span class="math inline">\(\widehat{Σ}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d + 1)(d + 2)/6\)</span> degrees of freedom.</h4>
</div>
</div>
<div id="answer-16" class="section level2">
<h2>Answer</h2>
<div id="we-first-repeat-example-6.8-which-evaluate-t1e-rate-of-mardias-multivariate-skewness-test.-in-our-simulation-we-generate-variables-following-nmusigma-where" class="section level4">
<h4>We first repeat Example 6.8 which evaluate t1e rate of Mardia’s multivariate skewness test. In our simulation we generate variables following <span class="math inline">\(N(\mu,\Sigma)\)</span>, where:</h4>
<p><span class="math display">\[\mu=(0,0,0)^{T} , \Sigma=\left( \begin{array}{ccc}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \end{array} \right).\]</span></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true"></a><span class="kw">library</span>(MASS)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;MASS&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true"></a>Mardia&lt;-<span class="cf">function</span>(mydata){</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true"></a>  n =<span class="st"> </span><span class="kw">nrow</span>(mydata)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true"></a>  c =<span class="st"> </span><span class="kw">ncol</span>(mydata)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true"></a>  central &lt;-<span class="st"> </span>mydata</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>c){</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true"></a>    central[,i] &lt;-<span class="st"> </span>mydata[,i]<span class="op">-</span><span class="kw">mean</span>(mydata[,i])</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true"></a>  }</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true"></a>  sigmah &lt;-<span class="st"> </span><span class="kw">t</span>(central)<span class="op">%*%</span>central<span class="op">/</span>n</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true"></a>  a &lt;-<span class="st"> </span>central<span class="op">%*%</span><span class="kw">solve</span>(sigmah)<span class="op">%*%</span><span class="kw">t</span>(central)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true"></a>  b &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">colSums</span>(a<span class="op">^</span>{<span class="dv">3</span>}))<span class="op">/</span>(n<span class="op">*</span>n)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true"></a>  test &lt;-<span class="st"> </span>n<span class="op">*</span>b<span class="op">/</span><span class="dv">6</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true"></a>  chi &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="fl">0.95</span>,c<span class="op">*</span>(c<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(c<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true"></a>  <span class="kw">as.integer</span>(test<span class="op">&gt;</span>chi)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true"></a>}</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true"></a>mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true"></a>sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true"></a>m =<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true"></a><span class="co">#m: number of replicates; n: sample size</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true"></a>a=<span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true"></a>  a[i]=<span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true"></a>    mydata &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n[i],mu,sigma) </span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true"></a>    <span class="kw">Mardia</span>(mydata)</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true"></a>  }))</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true"></a>}</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true"></a></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true"></a><span class="kw">print</span>(a) <span class="co">#calculate the t1e</span></span></code></pre></div>
<pre><code>## [1] 0.001 0.019 0.030 0.045 0.040 0.039</code></pre>
<p>We further repeat Example 6.8 which evaluate the power of Mardia’s multivariate skewness test under distribution <span class="math inline">\((1-\epsilon)N(\mu_{1},\Sigma_{1})+\epsilon N(\mu_{2},\Sigma_{2})\)</span>, where: <span class="math display">\[\mu_{1}=\mu_{2}=(0,0,0)^{T}, \Sigma_{1}=\left( \begin{array}{ccc}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \end{array} \right)
\Sigma_{2}=\left( \begin{array}{ccc}
100 &amp; 0 &amp; 0 \\
0 &amp; 100 &amp; 0 \\
0 &amp; 0 &amp; 100 \end{array} \right).\]</span></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true"></a><span class="kw">library</span>(MASS)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true"></a>sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true"></a>sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true"></a>sigma=<span class="kw">list</span>(sigma1,sigma2)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true"></a>m=<span class="dv">1000</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true"></a>n=<span class="dv">50</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true"></a><span class="co">#m: number of replicates; n: sample size</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true"></a>epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.06</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true"></a>  e &lt;-<span class="st"> </span>epsilon[j]</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true"></a>    index=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true"></a>    mydata&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>n,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true"></a>    <span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true"></a>      <span class="cf">if</span>(index[t]<span class="op">==</span><span class="dv">1</span>) mydata[t,]=<span class="kw">mvrnorm</span>(<span class="dv">1</span>,mu1,sigma1) </span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true"></a>      <span class="cf">else</span> mydata[t,]=<span class="kw">mvrnorm</span>(<span class="dv">1</span>,mu2,sigma2)</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true"></a>    }</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true"></a>    sktests[i] &lt;-<span class="st"> </span><span class="kw">Mardia</span>(mydata)</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true"></a>  }</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true"></a>  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true"></a>}</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true"></a><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true"></a>     <span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> ## Discussion #### If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<div id="what-is-the-corresponding-hypothesis-test-problem" class="section level5">
<h5>What is the corresponding hypothesis test problem?</h5>
</div>
<div id="what-test-should-we-use-z-test-two-sample-t-test-paired-t-test-or-mcnemar-test" class="section level5">
<h5>What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</h5>
</div>
<div id="what-information-is-needed-to-test-your-hypothes-is" class="section level5">
<h5>What information is needed to test your hypothes is?</h5>
</div>
</div>
</div>
<div id="answer-17" class="section level2">
<h2>Answer</h2>
<div id="h_0-the-power-of-method1-is-equal-to-the-power-of-method2." class="section level4">
<h4>1.<span class="math inline">\(H_0\)</span>: The power of method1 is equal to the power of method2.</h4>
</div>
<div id="h_1-the-power-of-method1-is-not-equal-to-the-power-of-method2." class="section level4">
<h4><span class="math inline">\(H_1\)</span>: The power of method1 is not equal to the power of method2.</h4>
</div>
<div id="we-can-not-apply-the-two-sample-t-test-because-the-p-value-of-two-methods-for-the-same-sample-is-not-independent.-for-the-z-test-and-paired-t-test-when-the-sample-size-is-large-we-have-the-mean-value-of-significance-test-follows-a-normal-distribution-thus-these-two-methods-can-be-used-in-the-approximate-level.-mcnemar-test-is-good-at-dealing-with-this-case-as-it-doesnt-need-to-know-the-distribution." class="section level4">
<h4>2.We can not apply the two-sample t-test, because the p-value of two methods for the same sample is not independent. For the z-test and paired-t test, when the sample size is large, we have the mean value of significance test follows a normal distribution, thus these two methods can be used in the approximate level. McNemar test is good at dealing with this case as it doesn’t need to know the distribution.</h4>
</div>
<div id="the-significance-of-both-methods-for-each-sample." class="section level4">
<h4>3.The significance of both methods for each sample.</h4>
</div>
</div>
</div>
<div id="section-5" class="section level1">
<h1>2020.11.3</h1>
<div id="question-7.1" class="section level2">
<h2>Question 7.1</h2>
<div id="compute-a-jackknife-estimate-of-the-bias-and-the-standard-error-of-the-correlation-statistic-in-example-7.2." class="section level4">
<h4>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</h4>
</div>
</div>
<div id="answer-18" class="section level2">
<h2>Answer</h2>
<div id="widehattext-bias_text-jackn-1leftoverlinehattheta_cdot-hatthetaright" class="section level4">
<h4><span class="math display">\[\widehat{\text {bias}}_{\text {jack}}=(n-1)\left(\overline{\hat{\theta}_{(\cdot)}}-\hat{\theta}\right)\]</span></h4>
<p><span class="math display">\[\widehat{s e}_{j a c k}=\sqrt{\frac{n-1}{n} \sum_{i=1}^{n}\left(\hat{\theta}_{(i)}-\overline{\hat{\theta}_{(\cdot)}}\right)^{2}}\]</span></p>
</div>
<div id="use-the-two-functions-above-then-we-get-the-correct-answer." class="section level4">
<h4>Use the two functions above, then we get the correct answer.</h4>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true"></a><span class="kw">library</span>(bootstrap)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;bootstrap&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true"></a><span class="kw">data</span>(law, <span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(law)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true"></a>LSAT &lt;-<span class="st"> </span>law<span class="op">$</span>LSAT</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true"></a>GPA &lt;-<span class="st"> </span>law<span class="op">$</span>GPA</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true"></a>cor.hat &lt;-<span class="st"> </span><span class="kw">cor</span>(LSAT,GPA)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true"></a><span class="co">#compute the jackknife replicates, leave-one-out estimates</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true"></a>cor.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true"></a>  cor.jack[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(LSAT[<span class="op">-</span>i],GPA[<span class="op">-</span>i])</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true"></a>bias &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(cor.jack) <span class="op">-</span><span class="st"> </span>cor.hat)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>) <span class="op">*</span><span class="kw">mean</span>((cor.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(cor.jack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true"></a><span class="kw">cat</span>(<span class="st">&quot;bias_jack:&quot;</span>,bias,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;se_jack:&quot;</span>,se)</span></code></pre></div>
<pre><code>## bias_jack: -0.006473623 
##  se_jack: 0.1425186</code></pre>
</div>
</div>
<div id="question-7.5" class="section level2">
<h2>Question 7.5</h2>
<div id="refer-to-exercise-7.4.-compute-95-bootstrap-confidence-intervals-for-the-mean-time-between-failures-1λ-by-the-standard-normal-basic-percentile-and-bca-methods.-compare-the-intervals-and-explain-why-they-may-differ." class="section level4">
<h4>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures 1/λ by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</h4>
</div>
</div>
<div id="answer-19" class="section level2">
<h2>Answer</h2>
<div id="the-four-methods-to-estimate-the-ci-of-the-mean-is-different.-the-basic-method-tends-to-have-the-lowest-limit-of-ciboth-upper-and-lower-and-the-bca-method-tends-to-have-the-highest-limit-of-ciboth-upper-and-lower.-i-think-the-reason-is-that-the-four-methods-use-the-different-methods-to-give-the-ci-while-the-test-and-the-variance-are-different." class="section level4">
<h4>The four methods to estimate the CI of the mean is different. The basic method tends to have the lowest limit of CI(both upper and lower), and the BCa method tends to have the highest limit of CI(both upper and lower). I think the reason is that the four methods use the different methods to give the CI, while the test and the variance are different.</h4>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true"></a><span class="kw">library</span>(boot)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;boot&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true"></a><span class="kw">data</span>(aircondit, <span class="dt">package =</span> <span class="st">&quot;boot&quot;</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true"></a>theta.boot &lt;-<span class="st"> </span><span class="cf">function</span>(hours, ind) {</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true"></a><span class="co">#function to compute the statistic</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true"></a>x &lt;-<span class="st"> </span>hours[ind, ]</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true"></a><span class="kw">mean</span>(x)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true"></a>}</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(aircondit, <span class="dt">statistic =</span> theta.boot, <span class="dt">R =</span> <span class="dv">2000</span>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true"></a><span class="kw">print</span>(boot.obj)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = aircondit, statistic = theta.boot, R = 2000)
## 
## 
## Bootstrap Statistics :
##     original  bias    std. error
## t1* 108.0833 0.83725    38.46941</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">boot.ci</span>(boot.obj,</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true"></a><span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;basic&quot;, &quot;norm&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 31.8, 182.6 )   ( 22.6, 168.2 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.9, 193.6 )   ( 57.0, 234.4 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
</div>
</div>
<div id="question-7.8" class="section level2">
<h2>Question 7.8</h2>
<div id="refer-to-exercise-7.7.-obtain-the-jackknife-estimates-of-bias-and-standard-error-of-hattheta." class="section level4">
<h4>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</h4>
</div>
</div>
<div id="answer-20" class="section level2">
<h2>Answer</h2>
<div id="i-wrote-the-pca-function-first-and-then-compute-the-value-of-hattheta-and-the-value-of-the-jackknife-estimates.-eventually-i-got-the-jackknife-estimates-of-bias-and-standard-error-of-hattheta." class="section level4">
<h4>I wrote the pca function first, and then compute the value of <span class="math inline">\(\hat{\theta}\)</span> and the value of the jackknife estimates. Eventually, I got the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</h4>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true"></a><span class="kw">data</span>(scor, <span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true"></a>lambda_hat &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(scor))<span class="op">$</span>values</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true"></a>theta_hat &lt;-<span class="st"> </span>lambda_hat[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lambda_hat)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor) <span class="co"># number of rows (data size)</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true"></a>theta_j &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true"></a>  x &lt;-<span class="st"> </span>scor [<span class="op">-</span>i,]</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true"></a>  lambda &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true"></a>  theta_j[i] &lt;-<span class="st"> </span>lambda[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lambda)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true"></a>  <span class="co"># the i-th entry of theta_j is the i-th &quot;leave-one-out&quot; estimation of theta</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true"></a>}</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true"></a>bias_jack &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta_j) <span class="op">-</span><span class="st"> </span>theta_hat)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true"></a><span class="co"># the estimated bias of theta_hat, using jackknife</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true"></a>se_jack &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">var</span>(theta_j) <span class="op">/</span><span class="st"> </span>n)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true"></a><span class="co"># the estimated se of theta_hat, using jackknife</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true"></a><span class="kw">cat</span>(<span class="st">&quot;theta.hat: &quot;</span>,theta_hat,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;bias_jack:&quot;</span>,bias_jack,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;se_jack:&quot;</span>,se_jack)</span></code></pre></div>
<pre><code>## theta.hat:  0.619115 
##  bias_jack: 0.001069139 
##  se_jack: 0.04955231</code></pre>
</div>
</div>
<div id="question-7.11" class="section level2">
<h2>Question 7.11</h2>
<div id="in-example-7.18-leave-one-out-n-fold-cross-validation-was-used-to-select-the-best-fitting-model.-use-leave-two-out-cross-validation-to-compare-the-models." class="section level4">
<h4>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</h4>
</div>
</div>
<div id="answer-21" class="section level2">
<h2>Answer</h2>
<div id="according-to-the-prediction-error-criterion-model-2-the-quadratic-model-would-be-the-best-fit-for-the-data." class="section level4">
<h4>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data.</h4>
</div>
<div id="the-fitted-regression-equation-for-model-2-is" class="section level4">
<h4>The fitted regression equation for Model 2 is</h4>
</div>
<div id="haty-25.22190--1.43158x-0.05408x2" class="section level4">
<h4><span class="math display">\[\hat{Y} = 25.22190 -1.43158X +0.05408X^2\]</span></h4>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true"></a><span class="kw">library</span>(DAAG); <span class="kw">attach</span>(ironslag)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;DAAG&#39;是用R版本4.0.3 来建造的</code></pre>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<pre><code>## 
## 载入程辑包：&#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true"></a>e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="dv">-1</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true"></a><span class="co"># fit models on leave-one-out samples</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n<span class="dv">-1</span>) {</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true"></a>y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k<span class="op">:-</span>(k<span class="op">+</span><span class="dv">1</span>)]</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true"></a>x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k<span class="op">:-</span>(k<span class="op">+</span><span class="dv">1</span>)]</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true"></a>J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true"></a>yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true"></a>yhat2 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true"></a>e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true"></a>e1[k<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>magnetic[k<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>yhat2</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true"></a>J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true"></a>yhat3 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true"></a>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true"></a>yhat4 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k<span class="op">+</span><span class="dv">1</span>] <span class="op">+</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true"></a>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k<span class="op">+</span><span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true"></a>e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true"></a>e2[k<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>magnetic[k<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>yhat4</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true"></a>J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true"></a>logyhat5 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true"></a>logyhat6 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true"></a>yhat5 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat5)</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true"></a>yhat6 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat6)</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true"></a>e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat5</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true"></a>e3[k<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>magnetic[k<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>yhat6</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true"></a>J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true"></a>logyhat7 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[k])</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true"></a>logyhat8 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[k<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true"></a>yhat7 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat7)</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true"></a>yhat8 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat8)</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true"></a>e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat7</span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true"></a>e4[k<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>magnetic[k<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>yhat8</span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true"></a>}</span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true"></a><span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 20.55106 18.67048 19.30915 21.43579</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true"></a>J2</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2))
## 
## Coefficients:
## (Intercept)            x       I(x^2)  
##    25.22190     -1.43158      0.05408</code></pre>
</div>
</div>
</div>
<div id="section-6" class="section level1">
<h1>2020.11.10</h1>
<div id="question-8.3" class="section level2">
<h2>Question 8.3</h2>
<div id="the-count-5-test-for-equal-variances-in-section-6.4-is-based-on-the-maximum-number-of-extreme-points.-example-6.15-shows-that-the-count-5-criterion-is-not-applicable-for-unequal-sample-sizes.-implement-a-permutation-test-for-equal-variance-based-on-the-maximum-number-of-extreme-points-that-applies-when-sample-sizes-are-not-necessarily-equal." class="section level4">
<h4>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</h4>
</div>
</div>
<div id="answer-22" class="section level2">
<h2>Answer</h2>
<div id="the-previous-method-has-the-average-of-p-value-of-0.26-but-when-we-implement-a-permutation-test-for-equal-variance-we-can-reduce-the-average-of-p-value-to-0.09." class="section level4">
<h4>The previous method has the average of p-value of 0.26, but when we Implement a permutation test for equal variance, we can reduce the average of p-value to 0.09.</h4>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true"></a><span class="co"># Count Five test</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true"></a>count5test =<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true"></a>X =<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true"></a>Y =<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true"></a>outx =<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true"></a>outy =<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true"></a><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true"></a>}</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true"></a><span class="co"># Count Five test permutation</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true"></a>count5test_permutation =<span class="st"> </span><span class="cf">function</span>(z) {</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true"></a></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true"></a>n =<span class="st"> </span><span class="kw">length</span>(z)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true"></a>x =<span class="st"> </span>z[<span class="dv">1</span><span class="op">:</span>(n<span class="op">/</span><span class="dv">2</span>)]</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true"></a>y =<span class="st"> </span>z[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>(n<span class="op">/</span><span class="dv">2</span>))]</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true"></a>X =<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true"></a>Y =<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true"></a>outx =<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y)) </span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true"></a>outy =<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true"></a><span class="co"># return 1 (reject) or 0 (do not reject H0) </span></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true"></a><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true"></a>}</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true"></a>permutation =<span class="st"> </span><span class="cf">function</span>(z,R) {</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true"></a>  n =<span class="st"> </span><span class="kw">length</span>(z)</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true"></a>  out =<span class="st"> </span><span class="kw">numeric</span>(R)</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true"></a>  <span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="st"> </span>R){</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true"></a>      p =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n ,n ,<span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true"></a>      out[r] =<span class="st"> </span><span class="kw">count5test_permutation</span>(z[p])</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true"></a>  }</span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true"></a>  <span class="kw">sum</span>(out)<span class="op">/</span>R</span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true"></a>}              </span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true"></a></span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true"></a></span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true"></a>n1 =<span class="st"> </span><span class="dv">20</span></span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true"></a>n2 =<span class="st"> </span><span class="dv">50</span></span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true"></a>mu1 =<span class="st"> </span>mu2 =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true"></a>sigma1 =<span class="st"> </span>sigma2 =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true"></a>m =<span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true"></a></span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true"></a>alphahat1 =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true"></a>x =<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true"></a>y =<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true"></a>x =<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) <span class="co">#centered by sample mean</span></span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true"></a>y =<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true"></a><span class="kw">count5test</span>(x, y)</span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true"></a>}))</span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true"></a>alphahat2 =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true"></a>x =<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true"></a>y =<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb62-52"><a href="#cb62-52" aria-hidden="true"></a>x =<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) <span class="co">#centered by sample mean </span></span>
<span id="cb62-53"><a href="#cb62-53" aria-hidden="true"></a>y =<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb62-54"><a href="#cb62-54" aria-hidden="true"></a>z =<span class="st"> </span><span class="kw">c</span>(x,y)</span>
<span id="cb62-55"><a href="#cb62-55" aria-hidden="true"></a><span class="kw">permutation</span>(z,<span class="dv">1000</span>) </span>
<span id="cb62-56"><a href="#cb62-56" aria-hidden="true"></a>})<span class="op">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb62-57"><a href="#cb62-57" aria-hidden="true"></a></span>
<span id="cb62-58"><a href="#cb62-58" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">count5test=</span>alphahat1,<span class="dt">count5test_permutation=</span>alphahat2),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##             count5test count5test_permutation 
##                  0.300                  0.039</code></pre>
</div>
<div id="design-experiments-for-evaluating-the-performance-of-the-nn-energy-and-ball-methods-in-various-situations." class="section level3">
<h3>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</h3>
<div id="unequal-variances-and-equal-expectations" class="section level4">
<h4>Unequal variances and equal expectations</h4>
</div>
<div id="non-normal-distributions-t-distribution-with-1-df-heavy-tailed-distribution-bimodel-distribution-mixture-of-two-normal-distributions" class="section level4">
<h4>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</h4>
</div>
<div id="unbalanced-samples-say-1-case-versus-10-controls" class="section level4">
<h4>Unbalanced samples (say, 1 case versus 10 controls)</h4>
</div>
<div id="note-the-parameters-should-be-chosen-such-that-the-powers-are-distinguishable-say-range-from-0.3-to-0.8" class="section level4">
<h4>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8)</h4>
</div>
</div>
</div>
<div id="answer-23" class="section level2">
<h2>Answer</h2>
<div id="i-design-four-experiments-for-evaluating-the-performance-of-the-nn-energy-and-ball-methods-in-various-situations-in-different-scenes." class="section level4">
<h4>I design four experiments for evaluating the performance of the NN, energy, and ball methods in various situations in different scenes.</h4>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true"></a><span class="kw">library</span>(RANN)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;RANN&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true"></a><span class="kw">library</span>(boot)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true"></a><span class="kw">library</span>(Ball)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Ball&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true"></a><span class="kw">library</span>(energy)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;energy&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true"></a><span class="kw">library</span>(MASS)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true"></a>  n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true"></a>  n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true"></a>  z &lt;-<span class="st"> </span>z[ix, ]</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>) </span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true"></a>  i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true"></a>  <span class="kw">return</span>((i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n))</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true"></a>}</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true"></a></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true"></a>                   <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k =</span>k)</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true"></a>  }</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true"></a><span class="co">#Unequal variances and equal expectations:</span></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true"></a>mu1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true"></a>sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true"></a>mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true"></a>sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true"></a>n1=n2=<span class="dv">20</span></span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true"></a>n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2 </span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true"></a>N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true"></a>k=<span class="dv">3</span></span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true"></a>R=<span class="dv">999</span></span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true"></a>m=<span class="dv">100</span></span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true"></a>  mydata1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n1,mu1,sigma1)</span>
<span id="cb70-39"><a href="#cb70-39" aria-hidden="true"></a>  mydata2 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n2,mu2,sigma2)</span>
<span id="cb70-40"><a href="#cb70-40" aria-hidden="true"></a>  mydata &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydata1,mydata2)</span>
<span id="cb70-41"><a href="#cb70-41" aria-hidden="true"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(mydata,N,k)<span class="op">$</span>p.value</span>
<span id="cb70-42"><a href="#cb70-42" aria-hidden="true"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(mydata,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb70-43"><a href="#cb70-43" aria-hidden="true"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>mydata1,<span class="dt">y=</span>mydata2,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">2846</span>)<span class="op">$</span>p.value</span>
<span id="cb70-44"><a href="#cb70-44" aria-hidden="true"></a>}</span>
<span id="cb70-45"><a href="#cb70-45" aria-hidden="true"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb70-46"><a href="#cb70-46" aria-hidden="true"></a>pow1 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb70-47"><a href="#cb70-47" aria-hidden="true"></a>pow1</span></code></pre></div>
<pre><code>## [1] 0.35 0.27 0.88</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true"></a><span class="co">#Non-normal distributions: t distribution with 1 df</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true"></a>m &lt;-<span class="st"> </span><span class="dv">100</span>; k&lt;-<span class="dv">3</span>; <span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">20</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">numeric</span>(n1)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true"></a>y &lt;-<span class="st"> </span><span class="kw">numeric</span>(n2)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true"></a>  mydata1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rt</span>(n1,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true"></a>  mydata2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rt</span>(n2,<span class="dv">2</span>,<span class="dv">5</span>),<span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true"></a>  mydata &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydata1,mydata2)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(mydata,N,k)<span class="op">$</span>p.value</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(mydata,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>mydata1,<span class="dt">y=</span>mydata2,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true"></a>}</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true"></a>pow2 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true"></a>pow2</span></code></pre></div>
<pre><code>## [1] 0.66 0.63 0.86</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true"></a><span class="co">#Non-normal distributions: bimodel distribution</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true"></a>m &lt;-<span class="st"> </span><span class="dv">100</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; <span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">20</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true"></a>rbimodel&lt;-<span class="cf">function</span>(n,mu1,mu2,sd1,sd2){</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true"></a>  index=<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,n,<span class="dt">replace=</span><span class="ot">TRUE</span>)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true"></a>  x=<span class="kw">numeric</span>(n)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true"></a>  index1&lt;-<span class="kw">which</span>(index<span class="op">==</span><span class="dv">1</span>)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true"></a>  x[index1]&lt;-<span class="kw">rnorm</span>(<span class="kw">length</span>(index1), mu1, sd1)</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true"></a>  index2&lt;-<span class="kw">which</span>(index<span class="op">==</span><span class="dv">2</span>)</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true"></a>  x[index2]&lt;-<span class="kw">rnorm</span>(<span class="kw">length</span>(index2), mu2, sd2)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true"></a>  <span class="kw">return</span>(x)</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true"></a>}</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true"></a>  mydata1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rbimodel</span>(n1,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true"></a>  mydata2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rbimodel</span>(n2,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">3</span>),<span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true"></a>  mydata &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydata1,mydata2)</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(mydata,N,k)<span class="op">$</span>p.value</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(mydata,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>mydata1,<span class="dt">y=</span>mydata2,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">2846</span>)<span class="op">$</span>p.value</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true"></a>}</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true"></a>pow3 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true"></a>pow3</span></code></pre></div>
<pre><code>## [1] 0.48 0.60 0.80</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true"></a><span class="co">#Unbalanced samples:</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true"></a>m &lt;-<span class="st"> </span><span class="dv">100</span>; k&lt;-<span class="dv">3</span>;<span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true"></a>n1 &lt;-<span class="st"> </span><span class="dv">10</span>; n2 &lt;-<span class="st"> </span><span class="dv">100</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true"></a>mu1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true"></a>sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true"></a>mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true"></a>sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true"></a>  mydata1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n1,mu1,sigma1)</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true"></a>  mydata2 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n2,mu2,sigma2)</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true"></a>  mydata &lt;-<span class="st"> </span><span class="kw">rbind</span>(mydata1,mydata2)</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(mydata,N,k)<span class="op">$</span>p.value</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(mydata,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>mydata1,<span class="dt">y=</span>mydata2,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">2846</span>)<span class="op">$</span>p.value</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true"></a>}</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true"></a>pow4 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true"></a>pow4</span></code></pre></div>
<pre><code>## [1] 0.10 0.36 0.73</code></pre>
</div>
</div>
</div>
<div id="section-7" class="section level1">
<h1>2020.11.17</h1>
<div id="question-9.4" class="section level2">
<h2>Question 9.4</h2>
<div id="implement-a-random-walk-metropolis-sampler-for-generating-the-standard-laplace-distribution-see-exercise-3.2.-for-the-increment-simulate-from-a-normal-distribution.-compare-the-chains-generated-when-different-variances-are-used-for-the-proposal-distribution.-also-compute-the-acceptance-rates-of-each-chain." class="section level4">
<h4>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</h4>
</div>
</div>
<div id="answer-24" class="section level2">
<h2>Answer</h2>
<div id="as-the-pdf-of-the-standard-laplace-distribution-is-fracexp-x2-rx_tyfracfyfx_texpx_t-y.-for-different-variances-of-0.05-0.5-2-16-the-rejection-number-k-are-413029581828-the-rejection-rate-are-0.0205-0.1510-0.4790-0.9140.-only-the-second-chain-and-the-third-chain-has-a-rejection-rate-in-the-range-0.15-0.5.-and-the-acceptance-rates-of-each-chain-are-0.9795-0.8490-0.5210-0.0860" class="section level4">
<h4>As the pdf of the standard Laplace distribution is <span class="math inline">\(\frac{exp{-|x|}{2}\)</span>, <span class="math inline">\(r(X_{t},y)=\frac{f(Y)}{f(X_{t}}=exp{|X_{t}|-|{Y}|}\)</span>. For different variances of <span class="math inline">\(0.05, 0.5, 2, 16\)</span>, the rejection number k are <span class="math inline">\(41,302,958,1828\)</span>, the rejection rate are <span class="math inline">\(0.0205 0.1510 0.4790 0.9140\)</span>. Only the second chain and the third chain has a rejection rate in the range [0.15, 0.5]. And the acceptance rates of each chain are <span class="math inline">\(0.9795 0.8490 0.5210 0.0860\)</span></h4>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true"></a>rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="st"> </span><span class="kw">abs</span>(y)))</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true"></a>      x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true"></a>        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true"></a>        k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true"></a>      }</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true"></a>    }</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true"></a>  }</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true"></a></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true"></a>N &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true"></a>x0 &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true"></a>rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true"></a>rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true"></a>rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true"></a>rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true"></a></span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k))</span></code></pre></div>
<pre><code>## [1]   27  362  927 1777</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">c</span>(rw1<span class="op">$</span>k<span class="op">/</span><span class="dv">2000</span>, rw2<span class="op">$</span>k<span class="op">/</span><span class="dv">2000</span>, rw3<span class="op">$</span>k<span class="op">/</span><span class="dv">2000</span>, rw4<span class="op">$</span>k<span class="op">/</span><span class="dv">2000</span>))</span></code></pre></div>
<pre><code>## [1] 0.0135 0.1810 0.4635 0.8885</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>rw1<span class="op">$</span>k<span class="op">/</span><span class="dv">2000</span>, <span class="dv">1</span><span class="op">-</span>rw2<span class="op">$</span>k<span class="op">/</span><span class="dv">2000</span>, <span class="dv">1</span><span class="op">-</span>rw3<span class="op">$</span>k<span class="op">/</span><span class="dv">2000</span>, <span class="dv">1</span><span class="op">-</span>rw4<span class="op">$</span>k<span class="op">/</span><span class="dv">2000</span>))</span></code></pre></div>
<pre><code>## [1] 0.9865 0.8190 0.5365 0.1115</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true"></a><span class="kw">plot</span>(rw1<span class="op">$</span>x,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true"></a><span class="kw">plot</span>(rw2<span class="op">$</span>x,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true"></a><span class="kw">plot</span>(rw3<span class="op">$</span>x,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true"></a><span class="kw">plot</span>(rw4<span class="op">$</span>x,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="for-exercise-9.4-use-the-gelman-rubin-method-to-monitor-convergence-of-the-chain-and-run-the-chain-until-it-converges-approximately-to-the-target-distribution-according-to-hatr-1.2." class="section level4">
<h4>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R} &lt; 1.2\)</span>.</h4>
</div>
</div>
<div id="answer-25" class="section level2">
<h2>Answer</h2>
<div id="from-the-last-question-i-guess-the-best-sigma-is-between-0.5-and-2-when-i-choose-1.2-as-the-given-distribution-the-chain-converges-before-2000." class="section level4">
<h4>From the last question, I guess the best <span class="math inline">\(\sigma\)</span> is between 0.5 and 2, when I choose 1.2 as the given distribution, the chain converges before 2000.</h4>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true"></a>psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true"></a>n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true"></a>k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true"></a>psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true"></a>B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true"></a>psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true"></a>W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true"></a>v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true"></a>r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true"></a><span class="kw">return</span>(r.hat)</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true"></a>}</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true"></a></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true"></a>k &lt;-<span class="st"> </span><span class="dv">4</span>    <span class="co"># four chains</span></span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>,<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">10</span>)    <span class="co"># overdispersed initial values</span></span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true"></a>N &lt;-<span class="st"> </span><span class="dv">10000</span>    <span class="co"># length of chains</span></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true"></a>b &lt;-<span class="st"> </span><span class="dv">200</span>    <span class="co"># burn-in length</span></span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true"></a></span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true"></a></span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>N)</span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true"></a>  X[i,] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(<span class="fl">0.5</span>,x0[i],N)<span class="op">$</span>x</span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true"></a><span class="cf">for</span> (j <span class="cf">in</span> (<span class="dv">1000</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb88-32"><a href="#cb88-32" aria-hidden="true"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb88-33"><a href="#cb88-33" aria-hidden="true"></a><span class="kw">plot</span>(rhat[(<span class="dv">1000</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;sigma=0.5&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb88-34"><a href="#cb88-34" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb88-35"><a href="#cb88-35" aria-hidden="true"></a></span>
<span id="cb88-36"><a href="#cb88-36" aria-hidden="true"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>N)</span>
<span id="cb88-37"><a href="#cb88-37" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb88-38"><a href="#cb88-38" aria-hidden="true"></a>  X[i,] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(<span class="dv">1</span>,x0[i],N)<span class="op">$</span>x</span>
<span id="cb88-39"><a href="#cb88-39" aria-hidden="true"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb88-40"><a href="#cb88-40" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb88-41"><a href="#cb88-41" aria-hidden="true"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb88-42"><a href="#cb88-42" aria-hidden="true"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb88-43"><a href="#cb88-43" aria-hidden="true"></a><span class="cf">for</span> (j <span class="cf">in</span> (<span class="dv">500</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb88-44"><a href="#cb88-44" aria-hidden="true"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb88-45"><a href="#cb88-45" aria-hidden="true"></a>x2 &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">which</span>(rhat<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>rhat<span class="op">&lt;</span><span class="fl">1.2</span>))</span>
<span id="cb88-46"><a href="#cb88-46" aria-hidden="true"></a><span class="kw">plot</span>(rhat[(<span class="dv">500</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;sigma=1&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb88-47"><a href="#cb88-47" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb88-48"><a href="#cb88-48" aria-hidden="true"></a></span>
<span id="cb88-49"><a href="#cb88-49" aria-hidden="true"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>N)</span>
<span id="cb88-50"><a href="#cb88-50" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb88-51"><a href="#cb88-51" aria-hidden="true"></a>  X[i,] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(<span class="dv">4</span>,x0[i],N)<span class="op">$</span>x</span>
<span id="cb88-52"><a href="#cb88-52" aria-hidden="true"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb88-53"><a href="#cb88-53" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb88-54"><a href="#cb88-54" aria-hidden="true"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb88-55"><a href="#cb88-55" aria-hidden="true"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb88-56"><a href="#cb88-56" aria-hidden="true"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb88-57"><a href="#cb88-57" aria-hidden="true"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb88-58"><a href="#cb88-58" aria-hidden="true"></a>x3 &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">which</span>(rhat<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>rhat<span class="op">&lt;</span><span class="fl">1.2</span>))</span>
<span id="cb88-59"><a href="#cb88-59" aria-hidden="true"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;sigma=4&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb88-60"><a href="#cb88-60" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb88-61"><a href="#cb88-61" aria-hidden="true"></a></span>
<span id="cb88-62"><a href="#cb88-62" aria-hidden="true"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>N)</span>
<span id="cb88-63"><a href="#cb88-63" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb88-64"><a href="#cb88-64" aria-hidden="true"></a>  X[i,] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(<span class="dv">16</span>,x0[i],N)<span class="op">$</span>x</span>
<span id="cb88-65"><a href="#cb88-65" aria-hidden="true"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb88-66"><a href="#cb88-66" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb88-67"><a href="#cb88-67" aria-hidden="true"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb88-68"><a href="#cb88-68" aria-hidden="true"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb88-69"><a href="#cb88-69" aria-hidden="true"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb88-70"><a href="#cb88-70" aria-hidden="true"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb88-71"><a href="#cb88-71" aria-hidden="true"></a>x4 &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">which</span>(rhat<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>rhat<span class="op">&lt;</span><span class="fl">1.2</span>))</span>
<span id="cb88-72"><a href="#cb88-72" aria-hidden="true"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;sigma=16&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb88-73"><a href="#cb88-73" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAVFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6AGY6kNtmAABmADpmOpBmtv+QOgCQOjqQOmaQ2/+2ZgC225C2///bkDrb25Db////tmb/25D//7b//9v///8HKweGAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJeElEQVR4nO2dC3fjJhCFtdvsNmmTNm686yT6//+zevkhC7gzAzNC0dxzchw0CO75jB5gkJrWlVSztoHa5YCAHBCQAwJyQEAOCMgBATkgIAcE5ICAHBCQAwJyQEAOCOgeUGMu4G9tPyitLgTIxkW8QgcEKqwH0PHhdypspQoBfTydD//vb4GwuR9C2tJVV9f7z8c22YKM/eC0uaFj13YcUFhjXR9PPxxQWOe6To0DCopyma8B0OxGEt3eahoKhWsANE+vA+j9z+tlfv6F2dmpGlA07IBAeO+APl+apr9VvD3EZn72Dujwo/vrLvJbAmRnqeuL/fXafZ6+v20IkKGlM6D29PDLAQU0HWKdjtHe/N4Bfb5MhBxQQNu8zBuepTcKyM6TAwKiAFrzzt4BBStcpu9/N3NAIG12lo7UM//CKgRk5mmrLcgBobQDAmkHhNJGphwQkAMC6qs5jFf0x0h494AO02+q07hQwE+dgGxcXUYUE4P2dQIycuWAgJrroXUITF9YfQCvBkDtEZ2kKwVk4op0ma8AUGiasAMCaWtA0dkdDgiGHRAIVwrIwlZDmN1RKyATWw1hdsfOAeHZHQ6o/ycxu8OsY9hWCQjP7jCyEqwoDcjAVkOY3dHWCsjCFu0y74BQ2AGBcK2A9H1tG5CBr60AiqyKrgeQFSFuC1L3Falg8YVVCkjfF7EFOSAUrhaQtrGtA1I35oCAyICMCPEBKRujArJqQvyTsj6gj6fH9v1n0wTmLjigrvjPl8dxtPUYnd1h4CNWDQGQrrNxRHFgkxhybSsGpOysa0H/vLYnAiAbQhJAqs66wk/fXj9fnodDLRQO/Kvrh5WObSumvvDxCULfXtN1rwso9oyzMWZoKB6utwWpWmMAMiEkA6Ro7aboxOyO+6wmfkjpaaueN3oLqhmQIiEOIAtC0vGfGgCZNCExIC1zXwWQGiHOcxSNfgpnpW8iOu76UkNrEG7CsZSK5ICUCPWFBjsZ17C2hUSFLEA69jjnIAtCOYDacE8kTzxA+gdZFiCNb5ALSJtQJqDyjYgJyHyMnN+ECyPiAtIf4QynU8MdizJKemQD0h/AY6UjpZQzyQdkOz4lvUoUQxTtHSdatNHwCymdKKmMTUELMh1+ybnPKGJTBMhw+CXrRqxEI5IBshtdyLxTzUckBKQ4usBL4wIznUoBaY4ucNKUIrOcigGp9AxVAOURakgL6hQqjvthpWmFZjhtSAvqFCqO+2GlqcWKjdIW1CUqVu48lxpvERulLahL11ySkRYgcSNqaAvqQNXlEOkBEtpsaAvqcN1KfcPFcMdUlehTtD/PbyJnGUaKLWjYnW2yGKC2DCNlQHxEN7mDsztyWrToM+4vmBaI9z2WbEHX+rPuy1hpYS10i+UBnQ3IKNkAaumMdABdLGSfE9UAtcS2rgjoaoLByRLQUB5yZ/SWzLtzfsoPL11EKWv9NvLsjrJugo5WAXQp/E7nCsmzO5QdhSo0BRSS9jmIKwcE5ICAHBAQBGQu4HdtP0F/EdOam5NimMzfKq/bAaE9HRDY0wGBPR0Q2NMBgT0dENjTAbmWckBADgjIAQE5ICAHBOSAgBwQkAMCckBAS0CfL6FfOO81TFWZss4/Anl/Ds8GIuYW+KGb4VtZAjr8SP3SecnVFzllnX8s9PH0PMyuo+WW+CGbEVhZAOrnnIbm4851+qPLMmWdfyzzvo9ZibkFfuhmBFYWgKYy0q4///2vyzZlnX8EMr88t6eH38TcfD8MMwIrMkDHx3c6oP4Yn+bRqwDimOFbEQH6+Ps3A1D/oM3jOI9eAxDHjMCKCNDhuWUACmYrB4hjRmBFcpKeZjw9V3GSZpkpcZImXn+HEmlXy372j+5lnmxGYGUJqPtKqDeKU9b5RyDveHdGzC3wQzfDt+JdDSAHBOTTX4Afn0AFKqwA0HAPcmqS73q29MNLq2sENDxw+5h+nrSVH15aXQOgvhMpWBau44eQtnRFAWTrh5A2BvT0/W146H/0rQg7BzTcynb3t/2zBYJhB4TCewfUNaCHX6k3s+wd0KHrYvd0/BwU0ngfNNws+lUsJAcE1FwXHN4eYrO+494BTQsO/TIflF/mgRwQ0E1dfpIOidSCDA1tEpClIQcE5ICAKgREeHbHvgERnt2xd0Dw2R17BwTDDgiEHdBy8+yX4AoAVTO8EAxXAGiWdkAg7YBAuj5Ado62CcjQkQMCckBADgiIBmjFq0Y4XBmgNS+r4bADAmEHBMIOCITtzoobBWTnaCuA7ie+mzWhrQBahB0QCFs1oSoBHcajKb0UYceAzhODQr/+OKDmuqA2vRTB6BjbLiAjUxUCuhxaoTl4Dqiv6kg5Se8ZEC1scxKqERD1NaImhIiATHvP5NeIWtiiATIdXmC8RnRFQHcroy8dRf1PzmtEDZpQhS0o+BrR+6Xsdl/c0l8obQqI8xpRdWM1AuKEHRAKazurGRBp3bz2ebpmQLSwAwJh5Sa0fUDKhL4AIF1zVEBmhASvEVU1RwRk14T6irivEd0dIO5rRDWbUJWA2GEHBMIOCIQVj7GtALqfvEDbS8FPFJAVIVELUrRHBWTWhGSA9Ox9GUBa/r4KIDVCdEArTRYgh5X8kQFZnafFgJTaOAOQzVGWAUjFHwvQGr9kMsIq9jiATI6yDEAqTZwHyIBQDiANQkxA+oTyAJV3F+9aRPo+VQNSIMRtQepn6jxA5QmxAWkjkvXmbzPq+iEA0kWU2YKKExIBshxe4IWHLEW9CQHpNaJ8QGUJSQEpdg7zXxtR0pockFrfp8BrIwpaywCkc5iVeW1EOWc5gJTuXIu8V6PYl5cHSKERUV4bQSuojLNMQOUR9aWh10YQSypiLBuQ9n0HLzzPW8JZAUBlG1FfFGlJJqmwfGMlABVF1FCXZNJKyzZWBlDRqwZ1xSGxvExjpQAVQ1QaUK6xcoDGIYkMK5cKQ0syycMdEWM5flhpbCWTUb87bUkmq1SxrcKA2vN3LbRT9DI/31HoqTygcTf54ZAVTu4qMqQEaNxXgukme/F3HEq+NU1AUwk8TnotaGaHnp+ZFot6GdIGdOcG9zWZ6Ww1wJsNILIde0A3RS9EqFDPz9JO0I8hoLAEazWU/fDS6hp688y1GpqKAcm6tc81xF2roakqW5A8XF4QkLmA37X9BP2ZbaSOz63oxwGBrQ4IbHVAYKsDAlsdENjqgMBWBwS2mt+pbk0OCMgBATkgIAcE5ICAHBDQ/8dNgdIkrJ4CAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="find-the-intersection-points-ak-in-0sqrtk-of-the-curves" class="section level4">
<h4>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt{k})\)</span> of the curves</h4>
</div>
<div id="s_k-1aplefttk-1sqrtfraca2k-1k-a2right" class="section level4">
<h4><span class="math display">\[S_{k-1}(a)=P\left(t(k-1)&gt;\sqrt{\frac{a^{2}(k-1)}{k-a^{2}}}\right)\]</span></h4>
</div>
<div id="and" class="section level4">
<h4>and</h4>
</div>
<div id="s_ka-plefttk-sqrtfraca2kk1-a2right" class="section level4">
<h4><span class="math display">\[S_{k}(a) = P\left(t(k) &gt; \sqrt{\frac{a^{2}(k)}{k+1-a^{2}}}\right)\]</span></h4>
</div>
<div id="for-k-4-25-100-500-1000-where-tk-is-a-student-t-random-variable-with-k-degrees-of-freedom.-these-intersection-points-determine-the-critical-values-for-a-t-test-for-scale-mixture-errors-proposed-by-szekely-260." class="section level4">
<h4>for <span class="math inline">\(k = 4 : 25, 100, 500, 1000\)</span>, where <span class="math inline">\(t(k)\)</span> is a Student <span class="math inline">\(t\)</span> random variable with <span class="math inline">\(k\)</span> degrees of freedom. (These intersection points determine the critical values for a <span class="math inline">\(t\)</span>-test for scale-mixture errors proposed by Sz´ekely [260].)</h4>
</div>
</div>
<div id="answer-26" class="section level2">
<h2>Answer</h2>
<div id="we-use-the-uniroot-function-to-solve-the-problem-because-the-denominator-can-be-zero-then-we-add-a-tiny-number-which-wont-influnce-the-answer-too-much-while-hleping-us-to-get-the-correct-answer." class="section level4">
<h4>We use the uniroot function to solve the problem, because the denominator can be zero, then we add a tiny number ,which won’t influnce the answer too much while hleping us to get the correct answer.</h4>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true"></a>k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>, <span class="dv">100</span>,<span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true"></a>out_root &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(k))</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true"></a>out_y &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(k))</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)){</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true"></a>  f &lt;-<span class="st"> </span><span class="cf">function</span>(a){</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true"></a>    <span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k[i]<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(k[i]<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df =</span>k[i]<span class="op">-</span><span class="dv">1</span>)<span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k[i]<span class="op">/</span>(k[i]<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df =</span> k[i])}</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true"></a>  out_root[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="fl">1e-10</span>,<span class="kw">sqrt</span>(k[i])<span class="op">-</span><span class="fl">1e-10</span>))<span class="op">$</span>root</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true"></a>  out_y[i] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="st"> </span><span class="kw">pt</span>(<span class="kw">sqrt</span>(out_root[i]<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k[i]<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(k[i]<span class="op">-</span>out_root[i]<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df =</span>k[i]<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true"></a>}</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">cbind</span>(out_root,out_y))</span></code></pre></div>
<pre><code>##           out_root      out_y
##  [1,] 1.492103e+00 0.07381509
##  [2,] 1.533549e+00 0.06627721
##  [3,] 1.562768e+00 0.06156493
##  [4,] 1.584421e+00 0.05836063
##  [5,] 1.601182e+00 0.05603462
##  [6,] 1.614517e+00 0.05427427
##  [7,] 1.625356e+00 0.05289920
##  [8,] 1.634398e+00 0.05178879
##  [9,] 1.642026e+00 0.05087706
## [10,] 1.648543e+00 0.05011580
## [11,] 1.654174e+00 0.04947074
## [12,] 1.659100e+00 0.04891605
## [13,] 1.663458e+00 0.04843237
## [14,] 1.667292e+00 0.04801253
## [15,] 1.670738e+00 0.04763940
## [16,] 1.673818e+00 0.04730943
## [17,] 1.676623e+00 0.04701163
## [18,] 1.679137e+00 0.04674700
## [19,] 1.681461e+00 0.04650431
## [20,] 4.795832e+00 0.00000000
## [21,] 4.898979e+00 0.00000000
## [22,] 5.000000e+00 0.00000000
## [23,] 1.000000e+01 0.00000000
## [24,] 2.236068e+01 0.00000000
## [25,] 1.000000e-10 0.50000000</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true"></a><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k),<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, out_root, <span class="dt">xlab =</span> <span class="st">&quot; &quot;</span>, <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="kw">A</span>(k)),<span class="dt">main =</span> <span class="st">&quot;points of insection&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="section-8" class="section level1">
<h1>2020.11.24</h1>
<div id="a-b-o-blood-type-problem" class="section level2">
<h2>A-B-O blood type problem</h2>
<div id="let-the-three-alleles-be-a-b-and-o." class="section level4">
<h4>Let the three alleles be A, B, and O.</h4>
</div>
<div id="genotype-aa-bb-oo-ao-bo-ab-sum" class="section level4">
<h4>Genotype AA BB OO AO BO AB Sum</h4>
</div>
<div id="frequency-p2-q2-r2-2pr-2qr-2pq-1" class="section level4">
<h4>Frequency p^2 q^2 r^2 2pr 2qr 2pq 1</h4>
</div>
<div id="count-naa-nbb-noo-nao-nbo-nab-n" class="section level4">
<h4>Count nAA nBB nOO nAO nBO nAB n</h4>
</div>
<div id="observed-data-na-naa-nao-444-a-typenb-nbb-nbo-132-b-type-noo-361-o-typenab-63-ab-type." class="section level4">
<h4>Observed data: nA· = nAA + nAO = 444 (A-type),nB· = nBB + nBO = 132 (B-type), nOO = 361 (O-type),nAB = 63 (AB-type).</h4>
</div>
<div id="use-em-algorithm-to-solve-mle-of-p-and-q-consider-missing-data-naa-and-nbb." class="section level4">
<h4>Use EM algorithm to solve MLE of p and q (consider missing data nAA and nBB).</h4>
</div>
<div id="record-the-values-of-p-and-q-that-maximize-the-conditional-likelihood-in-each-em-steps-calculate-the-corresponding-log-maximum-likelihood-values-for-observed-data-are-they-increasing" class="section level4">
<h4>Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</h4>
</div>
</div>
<div id="answer-27" class="section level2">
<h2>Answer</h2>
<div id="observed-data-likelihood" class="section level4">
<h4>Observed data likelihood</h4>
</div>
<div id="lpn_acdotn_bcdotn_oon_abp22prn_acdotq22qrn_bcdotr2n_oo2pqn_ab" class="section level4">
<h4><span class="math display">\[L(P|n_{A\cdot},n_{B\cdot},n_{OO},n_{AB})=(p^2+2pr)^{n_{A\cdot}}(q^2+2qr)^{n_{B\cdot}}(r^2)^{n_{OO}}(2pq)^{n_{AB}}\]</span></h4>
</div>
<div id="complete-data-likelihood" class="section level4">
<h4>Complete data likelihood</h4>
</div>
<div id="lpn_aan_bbn_oon_aon_bon_abp2n_aaq2n_bbr2n_oo2prn_ao2pqn_ab2qrn_bo" class="section level4">
<h4><span class="math display">\[L(P|n_{AA},n_{BB},n_{OO},n_{AO},n_{BO},n_{AB})=(p^2)^{n_{AA}}(q^2)^{n_{BB}}(r^2)^{n_{OO}}(2pr)^{n_{AO}}(2pq)^{n_{AB}}(2qr)^{n_{BO}}\]</span></h4>
</div>
<div id="lpn_aan_bbn_oon_acdotn_bcdotn_abn_aalogfracprn_acdotlogprn_bblogfracqrn_bcdotlogqr" class="section level4">
<h4><span class="math display">\[l(P|n_{AA},n_{BB},n_{OO},n_{A\cdot},n_{B\cdot},n_{AB})=n_{AA}log(\frac{p}{r})+n_{A\cdot}log(pr)+n_{BB}log(\frac{q}{r})+n_{B\cdot}log(qr)\]</span></h4>
</div>
<div id="n_oologrn_ablogpq" class="section level4">
<h4><span class="math display">\[+2n_{OO}log(r)+n_{AB}log(pq)\]</span></h4>
</div>
<div id="e-step" class="section level4">
<h4>E-step</h4>
</div>
<div id="e-n_acdotfracwidehatp_02-widehatp_0-2widehatq_0logfracp1-p-qn_acdotlogp1-p-qn_bcdotfracwidehatq_02-widehatq_0-2widehatp_0logfracq1-p-qn_bcdotlogq1-p-q2n_oolog1-p-qn_ablogpq" class="section level4">
<h4><span class="math display">\[E = n_{A\cdot}\frac{\widehat{p_{0}}}{2-\widehat{p_{0}}-2\widehat{q_{0}}}log(\frac{p}{1-p-q})+n_{A\cdot}log(p(1-p-q))+n_{B\cdot}\frac{\widehat{q_{0}}}{2-\widehat{q_{0}}-2\widehat{p_{0}}}log(\frac{q}{1-p-q})+n_{B\cdot}log(q(1-p-q))+2n_{OO}log(1-p-q)+n_{AB}log(pq)\]</span></h4>
</div>
<div id="p-0.29q-0.11" class="section level4">
<h4><span class="math display">\[p = 0.29,q = 0.11\]</span></h4>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true"></a><span class="kw">library</span>(nloptr)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true"></a><span class="co"># Mle </span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true"></a>eval_f0 =<span class="st"> </span><span class="cf">function</span>(x,x1,<span class="dt">n.A=</span><span class="dv">444</span>,<span class="dt">n.B=</span><span class="dv">132</span>,<span class="dt">nOO=</span><span class="dv">361</span>,<span class="dt">nAB=</span><span class="dv">63</span>) {</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true"></a>  </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true"></a>  r1 =<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(x1)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true"></a>  nAA =<span class="st"> </span>n.A<span class="op">*</span>x1[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(x1[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>x1[<span class="dv">1</span>]<span class="op">*</span>r1)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true"></a>  nBB =<span class="st"> </span>n.B<span class="op">*</span>x1[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(x1[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>x1[<span class="dv">2</span>]<span class="op">*</span>r1)</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true"></a>  r =<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(x)</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true"></a>  <span class="kw">return</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nAA<span class="op">*</span><span class="kw">log</span>(x[<span class="dv">1</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nBB<span class="op">*</span><span class="kw">log</span>(x[<span class="dv">2</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">*</span><span class="kw">log</span>(r)<span class="op">-</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true"></a><span class="st">           </span>(n.A<span class="op">-</span>nAA)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>r)<span class="op">-</span>(n.B<span class="op">-</span>nBB)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">2</span>]<span class="op">*</span>r)<span class="op">-</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>x[<span class="dv">2</span>]))</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true"></a>}</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true"></a></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true"></a></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true"></a><span class="co"># constraint</span></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true"></a>eval_g0 =<span class="st"> </span><span class="cf">function</span>(x,x1,<span class="dt">n.A=</span><span class="dv">444</span>,<span class="dt">n.B=</span><span class="dv">132</span>,<span class="dt">nOO=</span><span class="dv">361</span>,<span class="dt">nAB=</span><span class="dv">63</span>) {</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true"></a>  <span class="kw">return</span>(<span class="kw">sum</span>(x)<span class="op">-</span><span class="fl">0.999999</span>)</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true"></a>}</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true"></a></span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true"></a>opts =<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;algorithm&quot;</span>=<span class="st">&quot;NLOPT_LN_COBYLA&quot;</span>,</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true"></a>             <span class="st">&quot;xtol_rel&quot;</span>=<span class="fl">1.0e-8</span>)</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true"></a>mle =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true"></a>r =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true"></a>r =<span class="st"> </span><span class="kw">rbind</span>(r,<span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.35</span>))<span class="co"># the beginning value of p0 and q0</span></span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true"></a>j =<span class="st"> </span><span class="dv">2</span></span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true"></a><span class="cf">while</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(r[j,]<span class="op">-</span>r[j<span class="dv">-1</span>,]))<span class="op">&gt;</span><span class="fl">1e-8</span>) {</span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true"></a>res =<span class="st"> </span><span class="kw">nloptr</span>( <span class="dt">x0=</span><span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.25</span>),</span>
<span id="cb92-27"><a href="#cb92-27" aria-hidden="true"></a>               <span class="dt">eval_f=</span>eval_f0,</span>
<span id="cb92-28"><a href="#cb92-28" aria-hidden="true"></a>               <span class="dt">lb =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">ub =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb92-29"><a href="#cb92-29" aria-hidden="true"></a>               <span class="dt">eval_g_ineq =</span> eval_g0, </span>
<span id="cb92-30"><a href="#cb92-30" aria-hidden="true"></a>               <span class="dt">opts =</span> opts, <span class="dt">x1=</span>r[j,],<span class="dt">n.A=</span><span class="dv">444</span>,<span class="dt">n.B=</span><span class="dv">132</span>,<span class="dt">nOO=</span><span class="dv">361</span>,<span class="dt">nAB=</span><span class="dv">63</span> )</span>
<span id="cb92-31"><a href="#cb92-31" aria-hidden="true"></a>j =<span class="st"> </span>j<span class="op">+</span><span class="dv">1</span></span>
<span id="cb92-32"><a href="#cb92-32" aria-hidden="true"></a>r =<span class="st"> </span><span class="kw">rbind</span>(r,res<span class="op">$</span>solution)</span>
<span id="cb92-33"><a href="#cb92-33" aria-hidden="true"></a>mle =<span class="st"> </span><span class="kw">c</span>(mle,<span class="kw">eval_f0</span>(<span class="dt">x=</span>r[j,],<span class="dt">x1=</span>r[j<span class="dv">-1</span>,]))</span>
<span id="cb92-34"><a href="#cb92-34" aria-hidden="true"></a>}</span>
<span id="cb92-35"><a href="#cb92-35" aria-hidden="true"></a><span class="co">#the result of EM algorithm</span></span>
<span id="cb92-36"><a href="#cb92-36" aria-hidden="true"></a>r </span></code></pre></div>
<pre><code>##            [,1]      [,2]
##  [1,] 0.0000000 0.0000000
##  [2,] 0.2000000 0.3500000
##  [3,] 0.2938636 0.1159800
##  [4,] 0.2977537 0.1034051
##  [5,] 0.2977020 0.1027454
##  [6,] 0.2976539 0.1027089
##  [7,] 0.2976433 0.1027065
##  [8,] 0.2976411 0.1027063
##  [9,] 0.2976407 0.1027063
## [10,] 0.2976407 0.1027063
## [11,] 0.2976407 0.1027063
## [12,] 0.2976407 0.1027063</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true"></a><span class="co">#the max likelihood values</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="op">-</span>mle,<span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAWlBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmZmZmtrZmtv+QOgCQZgCQkGaQ2/+2ZgC2/7a2///bkDrb/9vb////tmb/25D//7b//9v////Y4K3VAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGX0lEQVR4nO3dgXLiNhhFYSdN0oa2oV227jqB93/NWpJhkybSkY0FP9I9M53Z7jI2fDGyIUJ0B5Wsu/YdsJ6AIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBK0M1N1M1wJad3PlEhAkIOh2gK40+lgHmj9YrpxtoKuxvLsLq99wtc1d76h5n1kgEzqHiwPlDilWeGweQTaeW1P2gCzpHOwBGeMxCLTubs5PQJAxIHM+AqIEBAkIEhBkC8iej4AoAUECggQECQgyBWTQR0CUqbdcGwLabwPD/T9zNtcOUN89hz8Mxz9kba4ZoP32xNI//MjenEWfMkBvm5fjH4fIk6xtIB1BVN9Nh9CsMaghoPFJFs5ikeNHQEs2Z9JHQFShs5gbeYaZF4qtAfnz17sTPm6uMaCJZsZpvjGg1ycPNONCsR6g8Rz+8GMXucAJN1hwBNn0WQI03H0bH3YYiL8uXAU9Ho7DddZ+qwFyryPccdFHz1Cu0ejuW/xCumYg99xxQLHRZel+qwE6HkG76MuIZfutBmgag06vRxNNZ7Ks/Rr1WXoW69wIE+34UvXzm67x96RrAuKmwbnVIyijt40boQSUaDc+BxsEio8un+q75xlAVn1Kvh/0+vSLgJLtt/FLgZqBjk+zVa+kKwLab8+6hI7styKg6JuE5+zXrM/C12JQxrmuYqDD66+JVxmh/ZYGqKqBnniQ3m8fZ+23JiB87L4BXuxXDKRBGm6YMUjP3q9dn0KDdChFWTHQ6RyOV9KNAuXXMFDeOPTFrSJvuQoovTnDPkWBsjcnINicgGBz9QGtvF8BpTdn2UdAlIAgAUECggwAmfYRECUgSECQgCABQdcHsu0jIEpAUCGg2MoLX7wn3STQnJUXWgSa87l54z5lgOasvNAkkI4gasbKC20CzVh5oVGg7M1Z9xEQVQho13WP/mIxNhutcSD/kU33sWf81HObQP40P/jPJNJpvk0gf6EYLhHpQrFNoPwjyLxP6TEoOg2kcaDss1izQLmbExBsrnEg/FCvfZ9Sp/nMlRdaBcpeeaFZoAUrL1it2Bg0d+UFq5UbpOetvGC2gmexWSsvmK3kaT658sLNVBBoSRm74ZusspG5j1hA6958aW0AzVhlaMFuKgDKWHnhjN3UAJS5+sCy3VQBhCsvnLGbOoCWJqDzd1MP0DqLWNxKAoIEBAkIEhB0M2/gXCsBQQKCBAQJCBIQJCBIQNAFgPyMK762hG88cSupwrt1fRef2RW28Zt/Q3RIfzvGx8oD7bfjvenpwY33Ogk0jP/6tklupPffOpQQetuECajudtlC5YHCL6rT36k0fXdX/J/Dy5vkRsLbwbu44RB+1RA2lbjdxy41BtGPrH/4KwWUtZZzGmjonv3k5bwf2KlLAe3Sd2gESI5Bw/33DQ1k+BQLs7uDdfaXYF0IKP6NZD532CeBevfsoN+p4ODrVcKxnD0IXQZogDEav7erv+MfuztIX59SPwizQHD8hKM+DeRpEhOTssYWq0+xnq6C+un32fGHHx5PcqjOODKMDtI53+l2gCMofOA6+WMPDzx5k8HkaT49LPwsfSXtRil4rzdzDDJ3oTg9f/AewUuNgV+v7Ogm0+HV23qpceMJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQZA/o07yC/IkGJRIQJCDIJNDb5s9NmG/mZqr87YD6MLXFTQyLLmZdJKNAbnL++J+bEzV00/+4yVFuDlVsJeIyGQV69lPqwqy63fQXfv7TcP/994s+44wCvfhpiacpc2EY8l47/NTHupkG6k9AP6fBLl1/Zmmmgf53BLn22z+WLvK0LNNA05Tm6S98/cO/l13XwDTQ9PmU6SwWRuuX/Enyq2Qb6ON10Aiz89OlLzlM2wMyloAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIOg/YeQHY4GZCSQAAAAASUVORK5CYII=" /><!-- --></p>
</div>
</div>
<div id="exercises-3" class="section level2">
<h2>Exercises 3</h2>
<div id="use-both-for-loops-and-lapply-to-fit-linear-models-to-the-mtcars-using-the-formulas-stored-in-this-list" class="section level4">
<h4>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</h4>
</div>
<div id="formulas---listmpg-disp-mpg-i1-dispmpg-disp-wtmpg-i1-disp-wt" class="section level4">
<h4>formulas &lt;- list(mpg ~ disp, mpg ~ I(1 / disp),mpg ~ disp + wt,mpg ~ I(1 / disp) + wt)</h4>
</div>
</div>
<div id="answer-28" class="section level2">
<h2>Answer</h2>
<div id="its-clear-that-the-loop-method-is-more-complex-than-the-lapply-function." class="section level4">
<h4>It’s clear that the loop method is more complex than the lapply function.</h4>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true"></a>  mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true"></a>  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true"></a>)</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true"></a></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true"></a><span class="co"># For loop</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true"></a>modle_loop &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="dt">length =</span> <span class="kw">length</span>(formulas))</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true"></a>i &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true"></a><span class="cf">for</span> (formula <span class="cf">in</span> formulas) { </span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true"></a>  modle_loop[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(formula, <span class="dt">data =</span> mtcars); </span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true"></a>  i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span> </span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true"></a>  }</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true"></a>modle_loop</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true"></a><span class="co"># lapply</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true"></a>modle_lapply &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas, lm, <span class="dt">data =</span> mtcars) </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true"></a>modle_lapply</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
</div>
<div id="exercise-3" class="section level2">
<h2>Exercise 3</h2>
<div id="the-following-code-simulates-the-performance-of-a-t-test-for-non-normal-data.-use-sapply-and-an-anonymous-function-to-extract-the-p-value-from-every-trial." class="section level4">
<h4>3. The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</h4>
</div>
<div id="trials---replicate100" class="section level4">
<h4>trials &lt;- replicate(100,</h4>
</div>
<div id="t.testrpois10-10-rpois7-10" class="section level4">
<h4>t.test(rpois(10, 10), rpois(7, 10)),</h4>
</div>
<div id="simplify-false" class="section level4">
<h4>simplify = FALSE)</h4>
</div>
<div id="extra-challenge-get-rid-of-the-anonymous-function-by-using-directly." class="section level4">
<h4>Extra challenge: get rid of the anonymous function by using [[ directly.</h4>
</div>
</div>
<div id="answer-29" class="section level2">
<h2>Answer</h2>
<div id="using-to-get-rid-of-the-anonymous-function." class="section level4">
<h4>Using [[ to get rid of the anonymous function.</h4>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true"></a>  <span class="dv">100</span>, </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true"></a>  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true"></a>  <span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true"></a>)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true"></a><span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="op">$</span>p.value)</span></code></pre></div>
<pre><code>##   [1] 0.008893789 0.620085661 0.762865602 0.540080333 0.131760620 0.969532263
##   [7] 0.036748127 0.585676871 0.155801310 0.936590945 0.439518289 0.603125309
##  [13] 0.482382011 0.281801202 0.128029120 0.198045411 0.413625524 0.687176640
##  [19] 0.111541048 0.095251694 0.736496407 0.622786553 0.836730500 0.770595212
##  [25] 0.370098013 0.454006783 0.023324063 0.178598347 0.826181450 0.642508229
##  [31] 0.214682589 0.260560237 0.641307040 0.675112842 0.537617059 0.689631491
##  [37] 0.138349986 0.817199498 0.514847745 0.940855660 0.943664168 0.928747733
##  [43] 0.912907604 0.036237785 0.196250431 0.745109680 0.810232263 0.402898765
##  [49] 0.018798761 0.842998504 0.143477017 0.628886815 0.074104516 0.651315699
##  [55] 0.811146034 0.251416293 0.088740583 0.500182979 0.344048605 0.200728815
##  [61] 0.012460214 0.331905614 0.927993407 0.742527503 0.091604774 0.117214425
##  [67] 0.068854159 0.238279651 0.006054057 0.255209937 0.799614556 0.870454331
##  [73] 0.510488619 0.967875377 0.617353717 0.746452965 0.143396102 0.788983134
##  [79] 0.027497724 0.828354480 0.058239174 0.086959008 0.650463499 0.186610429
##  [85] 0.475004380 0.125242938 0.424070991 0.174304214 0.153201305 0.187400477
##  [91] 0.726711614 0.617645386 0.788208451 0.341051216 0.908631683 0.907396257
##  [97] 0.166429609 0.897337462 0.150899046 0.795835104</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true"></a><span class="co">### Extra challenge: get rid of the anonymous function by using [[ directly.</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true"></a><span class="kw">sapply</span>(trials, <span class="st">`</span><span class="dt">[[</span><span class="st">`</span>, <span class="st">&#39;p.value&#39;</span>)</span></code></pre></div>
<pre><code>##   [1] 0.008893789 0.620085661 0.762865602 0.540080333 0.131760620 0.969532263
##   [7] 0.036748127 0.585676871 0.155801310 0.936590945 0.439518289 0.603125309
##  [13] 0.482382011 0.281801202 0.128029120 0.198045411 0.413625524 0.687176640
##  [19] 0.111541048 0.095251694 0.736496407 0.622786553 0.836730500 0.770595212
##  [25] 0.370098013 0.454006783 0.023324063 0.178598347 0.826181450 0.642508229
##  [31] 0.214682589 0.260560237 0.641307040 0.675112842 0.537617059 0.689631491
##  [37] 0.138349986 0.817199498 0.514847745 0.940855660 0.943664168 0.928747733
##  [43] 0.912907604 0.036237785 0.196250431 0.745109680 0.810232263 0.402898765
##  [49] 0.018798761 0.842998504 0.143477017 0.628886815 0.074104516 0.651315699
##  [55] 0.811146034 0.251416293 0.088740583 0.500182979 0.344048605 0.200728815
##  [61] 0.012460214 0.331905614 0.927993407 0.742527503 0.091604774 0.117214425
##  [67] 0.068854159 0.238279651 0.006054057 0.255209937 0.799614556 0.870454331
##  [73] 0.510488619 0.967875377 0.617353717 0.746452965 0.143396102 0.788983134
##  [79] 0.027497724 0.828354480 0.058239174 0.086959008 0.650463499 0.186610429
##  [85] 0.475004380 0.125242938 0.424070991 0.174304214 0.153201305 0.187400477
##  [91] 0.726711614 0.617645386 0.788208451 0.341051216 0.908631683 0.907396257
##  [97] 0.166429609 0.897337462 0.150899046 0.795835104</code></pre>
</div>
</div>
<div id="exercise-6" class="section level2">
<h2>Exercise 6</h2>
<div id="implement-a-combination-of-map-and-vapply-to-create-an-lapply-variant-that-iterates-in-parallel-over-all-of-its-inputs-and-stores-its-outputs-in-a-vector-or-a-matrix.-what-arguments-should-the-function-take" class="section level4">
<h4>6. Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</h4>
</div>
</div>
<div id="answer-30" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true"></a>lapply_variant &lt;-<span class="st"> </span><span class="cf">function</span>(x, f, ...) {</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true"></a>  indices &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">seq_along</span>(x))</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true"></a>  raw1 &lt;-<span class="st"> </span><span class="kw">vapply</span>(indices, <span class="cf">function</span>(i) <span class="kw">f</span>(x[[i]], ...), <span class="kw">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true"></a>  out &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(x))</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true"></a>    out[indices[j]] &lt;-<span class="st"> </span>raw1[j] </span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true"></a>  }</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true"></a>  out</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true"></a>}</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true"></a></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true"></a><span class="kw">all.equal</span>(<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="cf">function</span>(x) x<span class="op">^</span><span class="dv">2</span>), <span class="kw">lapply_variant</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="cf">function</span>(x) x<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
<div id="section-9" class="section level1">
<h1>2020.12.1</h1>
<div id="section-10" class="section level2">
<h2>9.4</h2>
<div id="implement-a-random-walk-metropolis-sampler-for-generating-the-standard-laplace-distribution-see-exercise-3.2.-for-the-increment-simulate-from-a-normal-distribution.-compare-the-chains-generated-when-different-variances-are-used-for-the-proposal-distribution.-also-compute-the-acceptance-rates-of-each-chain.-1" class="section level4">
<h4>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</h4>
</div>
<div id="write-an-rcpp-function-for-exercise-9.4" class="section level4">
<h4>Write an Rcpp function for Exercise 9.4</h4>
</div>
<div id="compare-the-corresponding-generated-random-numbers-with-those-by-the-r-function-you-wrote-before-using-the-function-qqplot." class="section level4">
<h4>Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</h4>
</div>
<div id="campare-the-computation-time-of-the-two-functions-with-the-function-microbenchmark." class="section level4">
<h4>Campare the computation time of the two functions with the function “microbenchmark”.</h4>
</div>
<div id="comments-your-results." class="section level4">
<h4>Comments your results.</h4>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true"></a><span class="kw">library</span>(Rcpp) <span class="co"># Attach R package &quot;Rcpp&quot;</span></span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Rcpp&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true"></a>    <span class="co"># Define function &quot;add&quot;</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true"></a><span class="kw">cppFunction</span>(<span class="st">&#39;// Add code below into C++ file Rcpp_example.cpp</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true"></a><span class="st">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true"></a><span class="st">using namespace Rcpp;</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true"></a></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true"></a><span class="st">// Place the export tag right above function declaration.</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true"></a><span class="st">//[[Rcpp::export]]</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true"></a><span class="st">NumericVector Metropolis( double sigma, double x0, int N) {</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true"></a><span class="st">  NumericVector x(N);</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true"></a><span class="st">  NumericVector u = runif(N);</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true"></a><span class="st">  x[0] = x0;</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true"></a><span class="st">  for (int i=1; i&lt;N; i++) { </span></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true"></a><span class="st">    NumericVector y = rnorm(1, x[i-1], sigma);</span></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true"></a><span class="st">    if (u[i] &lt;= exp(abs(x[i-1])- abs(y[0]))){</span></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true"></a><span class="st">        x[i] = y[0]; </span></span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true"></a><span class="st">    }</span></span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true"></a><span class="st">    else {</span></span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true"></a><span class="st">        x[i] = x[i-1];</span></span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true"></a><span class="st">    }</span></span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true"></a><span class="st">  }</span></span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true"></a><span class="st">  return(x);</span></span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true"></a><span class="st">}</span></span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true"></a><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: No function found for Rcpp::export attribute at file287c65d95ee2.cpp:5</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true"></a><span class="kw">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;microbenchmark&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true"></a>rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="st"> </span><span class="kw">abs</span>(y)))</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true"></a>      x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true"></a>        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true"></a>        k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true"></a>      }</span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true"></a>    }</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true"></a>}</span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true"></a></span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true"></a>ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">meanR=</span><span class="kw">rw.Metropolis</span>(<span class="dv">2</span>, <span class="dv">25</span>, <span class="dv">1000</span>),<span class="dt">meancpp=</span><span class="kw">Metropolis</span>(<span class="dv">2</span>, <span class="dv">25</span>, <span class="dv">1000</span>))</span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true"></a><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##      expr      lq median     uq
## 1   meanR 2598.85 2694.7 2833.5
## 2 meancpp  170.50  174.3  182.8</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true"></a>x0 =<span class="st"> </span><span class="dv">25</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true"></a>N =<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true"></a>sigma =<span class="st"> </span><span class="dv">2</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true"></a>rwR =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma,x0,N)<span class="op">$</span>x[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>)]</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true"></a>rwC =<span class="st"> </span><span class="kw">Metropolis</span>(sigma,x0,N)[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>)]</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true"></a><span class="kw">qqplot</span>(rwR,rwC)</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&#39;black&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="its-clear-that-rcpp-has-a-more-quick-speed-of-running-the-function-and-they-have-the-same-distribution-from-the-qqplot-so-we-should-use-the-rcpp-to-make-our-programme-quicker." class="section level4">
<h4>It’s clear that rcpp has a more quick speed of running the function, and they have the same distribution from the qqplot, so we should use the rcpp to make our programme quicker.</h4>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
